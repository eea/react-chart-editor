{"version":3,"file":"TransformAccordion.js","names":["_PlotlyFold","_interopRequireDefault","require","_PlotlyPanel","_propTypes","_react","_interopRequireWildcard","_lib","_PanelEmpty","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","enterModule","reactHotLoaderGlobal","undefined","module","__signature__","signature","TransformFold","connectTransformToTrace","PlotlyFold","TransformAccordion","Component","render","fullContainer","transforms","localize","_","container","dataSourceOptions","context","children","props","transformTypes","label","type","transformBy","map","tr","foldNameSuffix","groupssrc","find","d","value","concat","targetsrc","filteredTransforms","filter","_ref","Boolean","content","length","createElement","key","transformIndex","name","_ref2","canDelete","addActionOptions","some","addAction","handler","_ref3","updateContainer","Array","isArray","payload","target","groups","styles","PanelMessage","icon","style","textAlign","__reactstandin__regenerateByEval","code","eval","contextTypes","PropTypes","object","func","array","propTypes","node","_default","_default2","exports","reactHotLoader","register","leaveModule"],"sources":["../../../src/components/containers/TransformAccordion.js"],"sourcesContent":["import PlotlyFold from './PlotlyFold';\nimport PlotlyPanel from './PlotlyPanel';\nimport PropTypes from 'prop-types';\nimport React, {Component} from 'react';\nimport {connectTransformToTrace} from 'lib';\nimport {PanelMessage} from './PanelEmpty';\n\nconst TransformFold = connectTransformToTrace(PlotlyFold);\n\nclass TransformAccordion extends Component {\n  render() {\n    const {\n      fullContainer: {transforms = []},\n      localize: _,\n      container,\n      dataSourceOptions,\n    } = this.context;\n    const {children} = this.props;\n\n    const transformTypes = [\n      {label: _('Filter'), type: 'filter'},\n      {label: _('Split'), type: 'groupby'},\n      {label: _('Aggregate'), type: 'aggregate'},\n      {label: _('Sort'), type: 'sort'},\n    ];\n\n    const transformBy =\n      container.transforms &&\n      container.transforms.map((tr) => {\n        let foldNameSuffix = '';\n        if (tr.groupssrc) {\n          const groupssrc =\n            dataSourceOptions && dataSourceOptions.find((d) => d.value === tr.groupssrc);\n          foldNameSuffix = `: ${groupssrc && groupssrc.label ? groupssrc.label : tr.groupssrc}`;\n        } else if (tr.targetsrc) {\n          const targetsrc =\n            dataSourceOptions && dataSourceOptions.find((d) => d.value === tr.targetsrc);\n          foldNameSuffix = `: ${targetsrc && targetsrc.label ? targetsrc.label : tr.targetsrc}`;\n        }\n        return foldNameSuffix;\n      });\n\n    const filteredTransforms = transforms.filter(({type}) => Boolean(type));\n    const content =\n      filteredTransforms.length &&\n      filteredTransforms.map((tr, i) => (\n        <TransformFold\n          key={i}\n          transformIndex={i}\n          name={`${transformTypes.filter(({type}) => type === tr.type)[0].label}${\n            transformBy && transformBy[i]\n          }`}\n          canDelete={true}\n        >\n          {children}\n        </TransformFold>\n      ));\n\n    // cannot have 2 Split transforms on one trace:\n    // https://github.com/plotly/plotly.js/issues/1742\n    const addActionOptions =\n      container.transforms && container.transforms.some((t) => t.type === 'groupby')\n        ? transformTypes.filter((t) => t.type !== 'groupby')\n        : transformTypes;\n\n    const addAction = {\n      label: _('Transform'),\n      handler: addActionOptions.map(({label, type}) => {\n        return {\n          label,\n          handler: (context) => {\n            const {fullContainer, updateContainer} = context;\n            if (updateContainer) {\n              const transformIndex = Array.isArray(fullContainer.transforms)\n                ? fullContainer.transforms.length\n                : 0;\n              const key = `transforms[${transformIndex}]`;\n\n              const payload = {type};\n              if (type === 'filter') {\n                payload.target = [];\n                payload.targetsrc = null;\n              } else if (type !== 'sort') {\n                payload.groupssrc = null;\n                payload.groups = null;\n              }\n\n              if (type === 'groupby') {\n                payload.styles = [];\n              }\n\n              updateContainer({[key]: payload});\n            }\n          },\n        };\n      }),\n    };\n\n    return (\n      <PlotlyPanel addAction={addAction}>\n        {content ? (\n          content\n        ) : (\n          <PanelMessage icon={null}>\n            <div style={{textAlign: 'left'}}>\n              <p>\n                <strong>{_('Filter')}</strong>{' '}\n                {_(' transforms allow you to filter data out from a trace.')}\n              </p>\n              <p>\n                <strong>{_('Split')}</strong>{' '}\n                {_(\n                  ' transforms allow you to create multiple traces from one source trace, so as to style them differently.'\n                )}\n              </p>\n              <p>\n                <strong>{_('Aggregate')}</strong>{' '}\n                {_(\n                  ' transforms allow you to summarize a trace using an aggregate function like \"average\" or \"minimum\".'\n                )}\n              </p>\n              <p>\n                <strong>{_('Sort')}</strong>{' '}\n                {_(\n                  ' transforms allow you to sort a trace, so as to control marker overlay or line connection order.'\n                )}\n              </p>\n            </div>\n            <p>{_('Click on the + button above to add a transform.')}</p>\n          </PanelMessage>\n        )}\n      </PlotlyPanel>\n    );\n  }\n}\n\nTransformAccordion.contextTypes = {\n  fullContainer: PropTypes.object,\n  localize: PropTypes.func,\n  container: PropTypes.object,\n  dataSourceOptions: PropTypes.array,\n};\n\nTransformAccordion.propTypes = {\n  children: PropTypes.node,\n};\n\nexport default TransformAccordion;\n"],"mappings":"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","ignoreList":[]}