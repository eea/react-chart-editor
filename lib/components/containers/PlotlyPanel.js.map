{"version":3,"file":"PlotlyPanel.js","names":["_PanelHeader","_interopRequireDefault","require","_PanelEmpty","_propTypes","_react","_interopRequireWildcard","_immutabilityHelper","_lib","_plotlyIcons","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","enterModule","reactHotLoaderGlobal","undefined","module","__signature__","signature","PanelErrorImpl","Component","render","localize","_","context","createElement","icon","EmbedIconIcon","heading","__reactstandin__regenerateByEval","key","code","eval","contextTypes","PropTypes","func","PanelError","Panel","constructor","props","state","individualFoldStates","hasError","toggleFolds","bind","toggleFold","getChildContext","deleteContainer","deleteAction","componentDidCatch","setState","hasOpen","length","some","s","map","index","update","$toggle","calculateFolds","numFolds","React","Children","forEach","children","child","type","plotly_editor_traits","foldable","newFoldStates","Array","fill","collapsedOnStart","addAction","componentDidUpdate","componentDidMount","canReorder","newChildren","cloneElement","folded","canMoveUp","canMoveDown","className","concat","noPadding","allowCollapse","showExpandCollapse","bem","exports","propTypes","object","node","bool","defaultProps","childContextTypes","PlotlyPanel","container_panel","no_visibility_forcing","_default","_default2","reactHotLoader","register","leaveModule"],"sources":["../../../src/components/containers/PlotlyPanel.js"],"sourcesContent":["import PanelHeader from './PanelHeader';\nimport PanelEmpty from './PanelEmpty';\nimport PropTypes from 'prop-types';\nimport React, {Component, cloneElement} from 'react';\nimport update from 'immutability-helper';\nimport {bem} from 'lib';\nimport {EmbedIconIcon} from 'plotly-icons';\n\nclass PanelErrorImpl extends Component {\n  render() {\n    const {localize: _} = this.context;\n\n    return (\n      <PanelEmpty icon={EmbedIconIcon} heading={_('Well this is embarrassing.')}>\n        <p>{_('This panel could not be displayed due to an error.')}</p>\n      </PanelEmpty>\n    );\n  }\n}\n\nPanelErrorImpl.contextTypes = {\n  localize: PropTypes.func,\n};\n\nconst PanelError = PanelErrorImpl;\n\nexport class Panel extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      individualFoldStates: [],\n      hasError: false,\n    };\n    this.toggleFolds = this.toggleFolds.bind(this);\n    this.toggleFold = this.toggleFold.bind(this);\n  }\n\n  getChildContext() {\n    return {\n      deleteContainer: this.props.deleteAction ? this.props.deleteAction : null,\n    };\n  }\n\n  componentDidCatch() {\n    this.setState({hasError: true});\n  }\n\n  toggleFolds() {\n    const {individualFoldStates} = this.state;\n    const hasOpen = individualFoldStates.length > 0 && individualFoldStates.some((s) => s !== true);\n    this.setState({\n      individualFoldStates: individualFoldStates.map(() => hasOpen),\n    });\n  }\n\n  toggleFold(index) {\n    this.setState(update(this.state, {individualFoldStates: {$toggle: [index]}}));\n  }\n\n  calculateFolds() {\n    // to get proper number of child folds and initialize component state\n    let numFolds = 0;\n\n    React.Children.forEach(this.props.children, (child) => {\n      if (((child && child.type && child.type.plotly_editor_traits) || {}).foldable) {\n        numFolds++;\n      }\n    });\n\n    if (this.state.individualFoldStates.length !== numFolds) {\n      const newFoldStates = new Array(numFolds).fill(this.props.collapsedOnStart);\n      this.setState({\n        individualFoldStates: this.props.addAction\n          ? newFoldStates.map((e, i) => i !== numFolds - 1)\n          : newFoldStates,\n      });\n    }\n  }\n\n  componentDidUpdate() {\n    this.calculateFolds();\n  }\n  componentDidMount() {\n    this.calculateFolds();\n  }\n\n  render() {\n    const {individualFoldStates, hasError} = this.state;\n    const {canReorder} = this.props;\n\n    if (hasError) {\n      return <PanelError />;\n    }\n\n    const newChildren = React.Children.map(this.props.children, (child, index) => {\n      if (((child && child.type && child.type.plotly_editor_traits) || {}).foldable) {\n        return cloneElement(child, {\n          key: index,\n          folded: individualFoldStates[index] || false,\n          toggleFold: () => this.toggleFold(index),\n          canMoveUp: canReorder && individualFoldStates.length > 1 && index > 0,\n          canMoveDown:\n            canReorder &&\n            individualFoldStates.length > 1 &&\n            index !== individualFoldStates.length - 1,\n        });\n      }\n      return child;\n    });\n\n    return (\n      <div className={`panel${this.props.noPadding ? ' panel--no-padding' : ''}`}>\n        <PanelHeader\n          addAction={this.props.addAction}\n          allowCollapse={this.props.showExpandCollapse && individualFoldStates.length > 1}\n          toggleFolds={this.toggleFolds}\n          hasOpen={individualFoldStates.some((s) => s === false)}\n        />\n        <div className={bem('panel', 'content')}>{newChildren}</div>\n      </div>\n    );\n  }\n}\n\nPanel.propTypes = {\n  addAction: PropTypes.object,\n  children: PropTypes.node,\n  deleteAction: PropTypes.func,\n  noPadding: PropTypes.bool,\n  showExpandCollapse: PropTypes.bool,\n  canReorder: PropTypes.bool,\n  collapsedOnStart: PropTypes.bool,\n};\n\nPanel.defaultProps = {\n  showExpandCollapse: true,\n  collapsedOnStart: false,\n};\n\nPanel.contextTypes = {\n  localize: PropTypes.func,\n};\n\nPanel.childContextTypes = {\n  deleteContainer: PropTypes.func,\n};\n\nclass PlotlyPanel extends Panel {}\n\nPlotlyPanel.plotly_editor_traits = {\n  container_panel: true,\n  no_visibility_forcing: true,\n};\n\nexport default PlotlyPanel;\n"],"mappings":"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","ignoreList":[]}