"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=exports.TraceTypeSelectorButton=void 0;var _react=_interopRequireWildcard(require("react"));var _propTypes=_interopRequireDefault(require("prop-types"));var _plotlyIcons=require("plotly-icons");var _Modal=_interopRequireDefault(require("../containers/Modal"));var _lib=require("../../lib");var _constants=require("../../lib/constants");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&{}.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,t&&t.set(e,n),n}(function(){var enterModule=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.enterModule:undefined;enterModule&&enterModule(module)})();var __signature__=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.default.signature:function(a){return a};const renderActionItems=(actionItems,item)=>actionItems?actionItems(item).map((action,i)=>!action.onClick?null:_react.default.createElement("a",{className:"trace-item__actions__item",key:i,"aria-label":action.label,"data-microtip-position":"top-left",role:"tooltip",onClick:action.onClick,target:"_blank"},action.icon)):null;const Item=_ref=>{let{item,active,handleClick,actions,showActions,complex}=_ref;const{label,value,icon}=item;const SimpleIcon=(0,_lib.renderTraceIcon)(icon?icon:value);const ComplexIcon=(0,_lib.renderTraceIcon)(icon?icon:value,"TraceType");return _react.default.createElement("div",{className:"trace-item".concat(active?" trace-item--active":""),onClick:handleClick},_react.default.createElement("div",{className:"trace-item__actions"},actions&&showActions?renderActionItems(actions,item):null),_react.default.createElement("div",{className:"trace-item__image"},!complex&&_react.default.createElement("div",{className:"trace-item__image__svg"},_react.default.createElement(SimpleIcon,{className:"trace-simple-icon"})),complex&&_react.default.createElement("div",{className:"trace-item__image__wrapper"},_react.default.createElement(ComplexIcon,{className:"trace-complex-icon"}))),_react.default.createElement("div",{className:"trace-item__label"},label))};Item.propTypes={item:_propTypes.default.object,active:_propTypes.default.bool,complex:_propTypes.default.bool,handleClick:_propTypes.default.func,actions:_propTypes.default.func,showActions:_propTypes.default.bool};Item.contextTypes={localize:_propTypes.default.func};class TraceTypeSelector extends _react.Component{constructor(props){super(props);this.selectAndClose=this.selectAndClose.bind(this);this.actions=this.actions.bind(this);this.renderCategories=this.renderCategories.bind(this);this.renderGrid=this.renderGrid.bind(this);this.renderSingleBlock=this.renderSingleBlock.bind(this)}selectAndClose(value){const{updateContainer,glByDefault,fullContainer:{type}}=this.props;const computedValue=(0,_lib.traceTypeToPlotlyInitFigure)(value);if((type&&type.endsWith("gl")||!_constants.TRACES_WITH_GL.includes(type)&&glByDefault)&&_constants.TRACES_WITH_GL.includes(computedValue.type)&&!computedValue.type.endsWith("gl")){computedValue.type+="gl"}updateContainer(computedValue);this.context.handleClose()}actions(_ref2){let{value}=_ref2;const{localize:_,chartHelp}=this.context;const onClick=(e,func)=>{e.stopPropagation();func();this.context.handleClose()};return[{label:_("Charts like this by Plotly users."),onClick:chartHelp[value]&&chartHelp[value].feedQuery&&(e=>onClick(e,()=>window.open("https://chart-studio.plotly.com/feed/?q=filetype:plot%20plottype:".concat(typeof chartHelp[value].feedQuery==="string"?chartHelp[value].feedQuery:value),"_blank"))),icon:_react.default.createElement(_plotlyIcons.SearchIcon,null)},{label:_("View tutorials on this chart type."),onClick:chartHelp[value]&&chartHelp[value].helpDoc&&(e=>onClick(e,()=>window.open(chartHelp[value].helpDoc,"_blank"))),icon:_react.default.createElement(_plotlyIcons.ThumnailViewIcon,null)},{label:_("See a basic example."),onClick:chartHelp[value]&&chartHelp[value].examplePlot&&(e=>onClick(e,chartHelp[value].examplePlot)),icon:_react.default.createElement(_plotlyIcons.GraphIcon,null)}]}renderCategories(){const{fullValue}=this.props;const{localize:_,chartHelp}=this.context;const{traceTypesConfig:{traces,categories,complex}}=this.props;return categories(_).map((category,i)=>{const items=traces(_).filter(_ref3=>{let{category:{value}}=_ref3;return value===category.value}).filter(i=>i.value!=="scattergl"&&i.value!=="scatterpolargl");const MAX_ITEMS=4;const columnClasses=items.length>MAX_ITEMS&&!category.maxColumns||category.maxColumns&&category.maxColumns>1?"trace-grid__column trace-grid__column--double":"trace-grid__column";return _react.default.createElement("div",{className:columnClasses,key:i},_react.default.createElement("div",{className:"trace-grid__column__header"},category.label),_react.default.createElement("div",{className:"trace-grid__column__items"},items.map(item=>_react.default.createElement(Item,{complex:complex,key:item.value,active:fullValue===item.value,item:item,actions:this.actions,handleClick:()=>this.selectAndClose(item.value),showActions:Boolean(chartHelp)}))))})}renderGrid(){return _react.default.createElement("div",{className:"trace-grid"},this.renderCategories())}renderSingleBlock(){const{fullValue}=this.props;const{localize:_}=this.context;const{traceTypesConfig:{traces,complex}}=this.props;return _react.default.createElement("div",{className:"trace-grid-single-block"},traces(_).map(item=>_react.default.createElement(Item,{key:item.value,complex:complex,active:fullValue===item.value,item:item,actions:this.actions,showActions:false,handleClick:()=>this.selectAndClose(item.value),style:{display:"inline-block"}})))}render(){const{localize:_}=this.context;const{traceTypesConfig:{categories}}=this.props;return _react.default.createElement(_Modal.default,{title:_("Select Trace Type")},categories?this.renderGrid():this.renderSingleBlock())}__reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}TraceTypeSelector.propTypes={updateContainer:_propTypes.default.func,fullValue:_propTypes.default.string,fullContainer:_propTypes.default.object,glByDefault:_propTypes.default.bool,traceTypesConfig:_propTypes.default.object};TraceTypeSelector.contextTypes={handleClose:_propTypes.default.func,localize:_propTypes.default.func,mapBoxAccess:_propTypes.default.bool,chartHelp:_propTypes.default.object};class TraceTypeSelectorButton extends _react.Component{render(){const{handleClick,container,traceTypesConfig:{traces}}=this.props;const{localize:_}=this.context;const inferredType=(0,_lib.plotlyTraceToCustomTrace)(container);const{label,icon,value}=traces(_).find(type=>type.value===inferredType);const Icon=(0,_lib.renderTraceIcon)(icon?icon:value);return _react.default.createElement("div",{className:"trace-type-select-button",onClick:handleClick?handleClick:null},_react.default.createElement("div",{className:"trace-type-select-button__icon"},_react.default.createElement(Icon,{className:"trace-icon"})),label)}__reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}exports.TraceTypeSelectorButton=TraceTypeSelectorButton;TraceTypeSelectorButton.propTypes={handleClick:_propTypes.default.func.isRequired,container:_propTypes.default.object,traceTypesConfig:_propTypes.default.object.isRequired};TraceTypeSelectorButton.contextTypes={localize:_propTypes.default.func};const _default=TraceTypeSelector;var _default2=exports.default=_default;;(function(){var reactHotLoader=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.default:undefined;if(!reactHotLoader){return}reactHotLoader.register(renderActionItems,"renderActionItems","/Users/razvan/Work/react-chart-editor/src/components/widgets/TraceTypeSelector.js");reactHotLoader.register(Item,"Item","/Users/razvan/Work/react-chart-editor/src/components/widgets/TraceTypeSelector.js");reactHotLoader.register(TraceTypeSelector,"TraceTypeSelector","/Users/razvan/Work/react-chart-editor/src/components/widgets/TraceTypeSelector.js");reactHotLoader.register(TraceTypeSelectorButton,"TraceTypeSelectorButton","/Users/razvan/Work/react-chart-editor/src/components/widgets/TraceTypeSelector.js");reactHotLoader.register(_default,"default","/Users/razvan/Work/react-chart-editor/src/components/widgets/TraceTypeSelector.js")})();;(function(){var leaveModule=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.leaveModule:undefined;leaveModule&&leaveModule(module)})();
//# sourceMappingURL=TraceTypeSelector.js.map