"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=exports.TraceTypeSelectorButton=void 0;var _react=_interopRequireWildcard(require("react"));var _propTypes=_interopRequireDefault(require("prop-types"));var _plotlyIcons=require("plotly-icons");var _Modal=_interopRequireDefault(require("../containers/Modal"));var _lib=require("../../lib");var _constants=require("../../lib/constants");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&{}.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,t&&t.set(e,n),n}(function(){var enterModule=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.enterModule:undefined;enterModule&&enterModule(module)})();var __signature__=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.default.signature:function(a){return a};var renderActionItems=(actionItems,item)=>actionItems?actionItems(item).map((action,i)=>!action.onClick?null:_react.default.createElement("a",{className:"trace-item__actions__item",key:i,"aria-label":action.label,"data-microtip-position":"top-left",role:"tooltip",onClick:action.onClick,target:"_blank"},action.icon)):null;var Item=_ref=>{var item=_ref.item,active=_ref.active,handleClick=_ref.handleClick,actions=_ref.actions,showActions=_ref.showActions,complex=_ref.complex;var label=item.label,value=item.value,icon=item.icon;var SimpleIcon=(0,_lib.renderTraceIcon)(icon?icon:value);var ComplexIcon=(0,_lib.renderTraceIcon)(icon?icon:value,"TraceType");return _react.default.createElement("div",{className:"trace-item".concat(active?" trace-item--active":""),onClick:handleClick},_react.default.createElement("div",{className:"trace-item__actions"},actions&&showActions?renderActionItems(actions,item):null),_react.default.createElement("div",{className:"trace-item__image"},!complex&&_react.default.createElement("div",{className:"trace-item__image__svg"},_react.default.createElement(SimpleIcon,null)),complex&&_react.default.createElement("div",{className:"trace-item__image__wrapper"},_react.default.createElement(ComplexIcon,null))),_react.default.createElement("div",{className:"trace-item__label"},label))};Item.propTypes={item:_propTypes.default.object,active:_propTypes.default.bool,complex:_propTypes.default.bool,handleClick:_propTypes.default.func,actions:_propTypes.default.func,showActions:_propTypes.default.bool};Item.contextTypes={localize:_propTypes.default.func};class TraceTypeSelector extends _react.Component{constructor(props){super(props);this.selectAndClose=this.selectAndClose.bind(this);this.actions=this.actions.bind(this);this.renderCategories=this.renderCategories.bind(this);this.renderGrid=this.renderGrid.bind(this);this.renderSingleBlock=this.renderSingleBlock.bind(this)}selectAndClose(value){var _this$props=this.props,updateContainer=_this$props.updateContainer,glByDefault=_this$props.glByDefault,type=_this$props.fullContainer.type;var computedValue=(0,_lib.traceTypeToPlotlyInitFigure)(value);if((type&&type.endsWith("gl")||!_constants.TRACES_WITH_GL.includes(type)&&glByDefault)&&_constants.TRACES_WITH_GL.includes(computedValue.type)&&!computedValue.type.endsWith("gl")){computedValue.type+="gl"}updateContainer(computedValue);this.context.handleClose()}actions(_ref2){var value=_ref2.value;var _this$context=this.context,_=_this$context.localize,chartHelp=_this$context.chartHelp;var onClick=(e,func)=>{e.stopPropagation();func();this.context.handleClose()};return[{label:_("Charts like this by Plotly users."),onClick:chartHelp[value]&&chartHelp[value].feedQuery&&(e=>onClick(e,()=>window.open("https://plot.ly/feed/?q=".concat(chartHelp[value]?chartHelp[value].feedQuery:value),"_blank"))),icon:_react.default.createElement(_plotlyIcons.SearchIcon,null)},{label:_("View tutorials on this chart type."),onClick:chartHelp[value]&&chartHelp[value].helpDoc&&(e=>onClick(e,()=>window.open(chartHelp[value].helpDoc,"_blank"))),icon:_react.default.createElement(_plotlyIcons.ThumnailViewIcon,null)},{label:_("See a basic example."),onClick:chartHelp[value]&&chartHelp[value].examplePlot&&(e=>onClick(e,chartHelp[value].examplePlot)),icon:_react.default.createElement(_plotlyIcons.GraphIcon,null)}]}renderCategories(){var fullValue=this.props.fullValue;var _this$context2=this.context,_=_this$context2.localize,chartHelp=_this$context2.chartHelp;var _this$props$traceType=this.props.traceTypesConfig,traces=_this$props$traceType.traces,categories=_this$props$traceType.categories,complex=_this$props$traceType.complex;return categories(_).map((category,i)=>{var items=traces(_).filter(_ref3=>{var value=_ref3.category.value;return value===category.value}).filter(i=>i.value!=="scattergl"&&i.value!=="scatterpolargl");var MAX_ITEMS=4;var columnClasses=items.length>MAX_ITEMS&&!category.maxColumns||category.maxColumns&&category.maxColumns>1?"trace-grid__column trace-grid__column--double":"trace-grid__column";return _react.default.createElement("div",{className:columnClasses,key:i},_react.default.createElement("div",{className:"trace-grid__column__header"},category.label),_react.default.createElement("div",{className:"trace-grid__column__items"},items.map(item=>_react.default.createElement(Item,{complex:complex,key:item.value,active:fullValue===item.value,item:item,actions:this.actions,handleClick:()=>this.selectAndClose(item.value),showActions:Boolean(chartHelp)}))))})}renderGrid(){return _react.default.createElement("div",{className:"trace-grid"},this.renderCategories())}renderSingleBlock(){var fullValue=this.props.fullValue;var _=this.context.localize;var _this$props$traceType2=this.props.traceTypesConfig,traces=_this$props$traceType2.traces,complex=_this$props$traceType2.complex;return _react.default.createElement("div",{className:"trace-grid-single-block"},traces(_).map(item=>_react.default.createElement(Item,{key:item.value,complex:complex,active:fullValue===item.value,item:item,actions:this.actions,showActions:false,handleClick:()=>this.selectAndClose(item.value),style:{display:"inline-block"}})))}render(){var _=this.context.localize;var categories=this.props.traceTypesConfig.categories;return _react.default.createElement(_Modal.default,{title:_("Select Trace Type")},categories?this.renderGrid():this.renderSingleBlock())}__reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}TraceTypeSelector.propTypes={updateContainer:_propTypes.default.func,fullValue:_propTypes.default.string,fullContainer:_propTypes.default.object,glByDefault:_propTypes.default.bool,traceTypesConfig:_propTypes.default.object};TraceTypeSelector.contextTypes={handleClose:_propTypes.default.func,localize:_propTypes.default.func,mapBoxAccess:_propTypes.default.bool,chartHelp:_propTypes.default.object};class TraceTypeSelectorButton extends _react.Component{render(){var _this$props2=this.props,handleClick=_this$props2.handleClick,container=_this$props2.container,traces=_this$props2.traceTypesConfig.traces;var _=this.context.localize;var inferredType=(0,_lib.plotlyTraceToCustomTrace)(container);var _traces$find=traces(_).find(type=>type.value===inferredType),label=_traces$find.label,icon=_traces$find.icon,value=_traces$find.value;var Icon=(0,_lib.renderTraceIcon)(icon?icon:value);return _react.default.createElement("div",{className:"trace-type-select-button",onClick:handleClick?handleClick:null},_react.default.createElement("div",{className:"trace-type-select-button__icon"},_react.default.createElement(Icon,null)),label)}__reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}exports.TraceTypeSelectorButton=TraceTypeSelectorButton;TraceTypeSelectorButton.propTypes={handleClick:_propTypes.default.func.isRequired,container:_propTypes.default.object,traceTypesConfig:_propTypes.default.object.isRequired};TraceTypeSelectorButton.contextTypes={localize:_propTypes.default.func};var _default=TraceTypeSelector;var _default2=exports.default=_default;;(function(){var reactHotLoader=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.default:undefined;if(!reactHotLoader){return}reactHotLoader.register(renderActionItems,"renderActionItems","/Users/razvan/Work/react-chart-editor/src/components/widgets/TraceTypeSelector.js");reactHotLoader.register(Item,"Item","/Users/razvan/Work/react-chart-editor/src/components/widgets/TraceTypeSelector.js");reactHotLoader.register(TraceTypeSelector,"TraceTypeSelector","/Users/razvan/Work/react-chart-editor/src/components/widgets/TraceTypeSelector.js");reactHotLoader.register(TraceTypeSelectorButton,"TraceTypeSelectorButton","/Users/razvan/Work/react-chart-editor/src/components/widgets/TraceTypeSelector.js");reactHotLoader.register(_default,"default","/Users/razvan/Work/react-chart-editor/src/components/widgets/TraceTypeSelector.js")})();;(function(){var leaveModule=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.leaveModule:undefined;leaveModule&&leaveModule(module)})();
//# sourceMappingURL=TraceTypeSelector.js.map