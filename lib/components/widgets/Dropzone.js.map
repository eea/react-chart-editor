{"version":3,"file":"Dropzone.js","names":["_react","_interopRequireWildcard","require","_propTypes","_interopRequireDefault","_reactDropzone","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","enterModule","reactHotLoaderGlobal","undefined","module","_extends","assign","bind","arguments","length","apply","__signature__","signature","Dropzone","Component","constructor","props","context","state","content","validFiletypes","image","geojson","onDrop","parsingError","renderSuccess","value","_","localize","fileType","createElement","className","style","backgroundImage","concat","features","UNSAFE_componentWillMount","setState","join","replaceAll","toUpperCase","optionalError","supportedFileTypes","onLoad","payload","target","result","parsedValue","JSON","parse","onUpdate","error","console","warn","accepted","rejections","reader","FileReader","onload","readAsDataURL","readAsText","map","errors","message","render","accept","activeClassName","rejectClassName","_ref","getRootProps","getInputProps","__reactstandin__regenerateByEval","key","code","eval","propTypes","PropTypes","string","isRequired","func","any","contextTypes","_default","_default2","exports","reactHotLoader","register","leaveModule"],"sources":["../../../src/components/widgets/Dropzone.js"],"sourcesContent":["import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport Drop from 'react-dropzone';\n\nclass Dropzone extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = {\n      content: '',\n    };\n\n    this.validFiletypes = {\n      image: [\n        'image/jpeg',\n        'image/jpg',\n        'image/svg',\n        'image/svg+xml',\n        'image/png',\n        'image/gif',\n        'image/bmp',\n        'image/webp',\n      ],\n      geojson: ['application/json'],\n    };\n\n    this.onDrop = this.onDrop.bind(this);\n    this.parsingError = this.parsingError.bind(this);\n    this.renderSuccess = this.renderSuccess.bind(this);\n  }\n\n  renderSuccess(value) {\n    const _ = this.context.localize;\n\n    if (this.props.fileType === 'image') {\n      return (\n        <div className=\"dropzone-container__image\" style={{backgroundImage: `url(${value})`}} />\n      );\n    }\n    if (this.props.fileType === 'geojson') {\n      return (\n        <div className=\"dropzone-container__message\">\n          <p>{_('GeoJSON loaded!')}</p>\n          <p>{value.features.length + _(' features detected.')}</p>\n        </div>\n      );\n    }\n\n    return <div className=\"dropzone-container__message\">{_('File loaded!')}</div>;\n  }\n\n  UNSAFE_componentWillMount() {\n    const _ = this.context.localize;\n\n    if (this.props.value && this.props.value !== '') {\n      this.setState({content: this.renderSuccess(this.props.value)});\n      return;\n    }\n\n    this.setState({\n      content: (\n        <div className=\"dropzone-container__message\">\n          <p>\n            {_('Drop the ') +\n              this.props.fileType +\n              _(' to upload here or click to choose a file from your computer.')}\n          </p>\n\n          {this.validFiletypes[this.props.fileType] ? (\n            <p>\n              {_('Supported formats are: ') +\n                this.validFiletypes[this.props.fileType]\n                  .join(', ')\n                  .replaceAll('image/', '')\n                  .toUpperCase() +\n                '.'}\n            </p>\n          ) : null}\n        </div>\n      ),\n    });\n  }\n\n  parsingError(optionalError) {\n    const _ = this.context.localize;\n    const supportedFileTypes =\n      this.props.fileType === 'image'\n        ? this.validFiletypes[this.props.fileType].join(', ').replaceAll('image/', '').toUpperCase()\n        : this.validFiletypes[this.props.fileType][0];\n\n    return (\n      <div className=\"dropzone-container__message\">\n        {_(\"Yikes! This doesn't look like a valid \") + this.props.fileType}\n        <p>{_('Try again with a supported file format: ') + supportedFileTypes + '.'}</p>\n        {optionalError && <p>{optionalError}</p>}\n      </div>\n    );\n  }\n\n  onLoad(e) {\n    try {\n      const payload = e.target.result;\n      const parsedValue = this.props.fileType === 'image' ? payload : JSON.parse(payload);\n      this.props.onUpdate(parsedValue);\n      this.setState({\n        content: this.renderSuccess(parsedValue),\n      });\n    } catch (error) {\n      console.warn(error); // eslint-disable-line\n      this.setState({\n        content: this.parsingError(),\n      });\n    }\n  }\n\n  onDrop(accepted, rejections) {\n    const _ = this.context.localize;\n    const reader = new FileReader();\n\n    if (accepted.length) {\n      if (accepted.length > 1) {\n        this.setState({\n          content: (\n            <div className=\"dropzone-container__message\">\n              <p>{_('Yikes! You can only upload one file at a time.')}</p>\n            </div>\n          ),\n        });\n        return;\n      }\n      this.setState({content: _('Loading...')});\n      reader.onload = (e) => this.onLoad(e);\n      if (this.props.fileType === 'image') {\n        reader.readAsDataURL(accepted[0]);\n      } else if (this.props.fileType === 'geojson') {\n        reader.readAsText(accepted[0]);\n      }\n    }\n\n    if (rejections.length) {\n      this.setState({\n        content: this.parsingError(rejections.map((r) => r.errors.map((e) => e.message))),\n      });\n    }\n  }\n\n  render() {\n    return (\n      <Drop\n        accept={this.validFiletypes[this.props.fileType]}\n        onDrop={this.onDrop}\n        activeClassName=\"dropzone-container--active\"\n        rejectClassName=\"dropzone-container--rejected\"\n      >\n        {({getRootProps, getInputProps}) => (\n          <div {...getRootProps()} className=\"dropzone-container\">\n            <input {...getInputProps()} />\n            <div className=\"dropzone-container__content\">{this.state.content}</div>\n          </div>\n        )}\n      </Drop>\n    );\n  }\n}\n\nDropzone.propTypes = {\n  fileType: PropTypes.string.isRequired,\n  onUpdate: PropTypes.func,\n  value: PropTypes.any,\n};\n\nDropzone.contextTypes = {\n  localize: PropTypes.func,\n};\n\nexport default Dropzone;\n"],"mappings":"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","ignoreList":[]}