{"version":3,"file":"LinkEditor.js","names":["_react","_interopRequireWildcard","require","_propTypes","_interopRequireDefault","_constants","_reactDom","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","enterModule","reactHotLoaderGlobal","undefined","module","__signature__","signature","LinkEditor","Component","constructor","props","state","position","getUpdatedPosition","originalLinkURL","linkURL","componentDidMount","trim","findDOMNode","input","focus","UNSAFE_componentWillReceiveProps","nextProps","linkID","setState","componentDidUpdate","setSelectionRange","length","x","y","coordinates","onInputChange","urlValue","onURLChange","onInputKeyDown","ev","key","RETURN_KEY","preventDefault","onClose","ESCAPE_KEY","render","localize","_","context","onBlur","onFocus","placeholderText","urlText","createElement","className","style","left","top","onChange","target","value","onKeyDown","ref","placeholder","__reactstandin__regenerateByEval","code","eval","propTypes","PropTypes","string","isRequired","func","shape","number","defaultProps","contextTypes","_default","_default2","exports","reactHotLoader","register","leaveModule"],"sources":["../../../../../src/components/widgets/text_editors/RichText/LinkEditor.js"],"sourcesContent":["/*\n * The LinkEditor is a simple UI component that floats below a selected link\n * in the RichTextEditor, and lets the user enter a URL.\n */\n\nimport React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport {RETURN_KEY, ESCAPE_KEY} from 'lib/constants';\nimport {findDOMNode} from 'react-dom';\n\nclass LinkEditor extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      // Use cached position to maintain position during times of focus.\n      position: this.getUpdatedPosition(props),\n      originalLinkURL: props.linkURL,\n    };\n  }\n\n  componentDidMount() {\n    // Focus the input field if the URL value is empty\n    if (this.props.linkURL.trim() === '') {\n      findDOMNode(this.input).focus();\n    }\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    const {props} = this;\n\n    // Update position if we are editing a new link\n    if (nextProps.linkID !== props.linkID) {\n      this.setState({\n        position: this.getUpdatedPosition(props),\n      });\n    }\n  }\n\n  componentDidUpdate() {\n    // Cursor dissappears when component rerenders, to make sure it's present\n    // we're using setSelection range to make it appear at the end of text:\n    // https://github.com/plotly/streambed/issues/9964\n    findDOMNode(this.input).setSelectionRange(this.props.linkURL.length, this.props.linkURL.length);\n  }\n\n  getUpdatedPosition(props) {\n    const {x, y} = props.coordinates;\n\n    return {x, y};\n  }\n\n  onInputChange(urlValue) {\n    const {linkID, onURLChange} = this.props;\n\n    // Call back to parent\n    onURLChange(linkID, urlValue);\n  }\n\n  onInputKeyDown(ev) {\n    /*\n     * `KeyboardEvent.key` enjoys excellent cross-browser support.\n     * https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key\n     */\n    const {key} = ev;\n\n    if (key === RETURN_KEY) {\n      // Save changes\n      ev.preventDefault();\n\n      this.props.onClose(this.props.linkID);\n    }\n\n    if (key === ESCAPE_KEY) {\n      // Cancel changes\n      ev.preventDefault();\n\n      // Restore original URL\n      this.onInputChange(this.state.originalLinkURL);\n\n      this.props.onClose(this.props.linkID);\n    }\n  }\n\n  render() {\n    const {localize: _} = this.context;\n    const {position} = this.state;\n    const {onBlur, onFocus, linkURL} = this.props;\n    const placeholderText = _('Enter Link URL');\n    const urlText = _('URL');\n    // TODO: add close button\n    return (\n      <div className=\"rich-text-editor__link-editor\" style={{left: position.x, top: position.y}}>\n        <span className=\"rich-text-editor__link-editor__label\">{urlText}</span>\n        <input\n          className=\"rich-text-editor__link-editor__input\"\n          onBlur={onBlur}\n          onFocus={onFocus}\n          onChange={(ev) => this.onInputChange(ev.target.value)}\n          onKeyDown={(ev) => this.onInputKeyDown(ev)}\n          ref={(input) => (this.input = input)}\n          value={linkURL}\n          placeholder={placeholderText}\n        />\n      </div>\n    );\n  }\n}\n\nLinkEditor.propTypes = {\n  linkID: PropTypes.string.isRequired,\n  linkURL: PropTypes.string.isRequired,\n  onBlur: PropTypes.func.isRequired,\n  onFocus: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onURLChange: PropTypes.func.isRequired,\n\n  coordinates: PropTypes.shape({\n    x: PropTypes.number,\n    y: PropTypes.number,\n  }),\n};\n\nLinkEditor.defaultProps = {\n  coordinates: {\n    x: 0,\n    y: 0,\n  },\n};\n\nLinkEditor.contextTypes = {\n  localize: PropTypes.func.isRequired,\n};\n\nexport default LinkEditor;\n"],"mappings":"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","ignoreList":[]}