{"version":3,"file":"AnnotationRef-test.js","names":["_derived","require","_Dropdown","_interopRequireDefault","_react","_","_testUtils","_lib","e","__esModule","default","enterModule","reactHotLoaderGlobal","undefined","module","ownKeys","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_toPropertyKey","value","configurable","writable","i","_toPrimitive","Symbol","toPrimitive","call","TypeError","String","Number","__signature__","signature","a","LayoutAnnoPanel","connectLayoutToPlot","connectAnnotationToLayout","PlotlyPanel","describe","render","props","mount","createElement","TestEditor","onUpdate","jest","fn","plotly","name","annotationIndex","AnnotationRef","attr","it","fixtureProps","fixtures","scatter","layout","annotations","text","drop","find","DropdownWidget","options","first","prop","expect","toBe","toEqual","label","beforeUpdateLayout","ayref","update","mock","calls","yref","AnnotationArrowRef","reactHotLoader","register","leaveModule"],"sources":["../../../../src/components/fields/__tests__/AnnotationRef-test.js"],"sourcesContent":["import {AnnotationRef, AnnotationArrowRef} from '../derived';\nimport DropdownWidget from '../../widgets/Dropdown';\nimport React from 'react';\nimport {PlotlyPanel} from '../../';\nimport {TestEditor, fixtures, plotly, mount} from 'lib/test-utils';\nimport {connectAnnotationToLayout, connectLayoutToPlot} from 'lib';\n\nconst LayoutAnnoPanel = connectLayoutToPlot(connectAnnotationToLayout(PlotlyPanel));\n\ndescribe('<AnnotationRef>', () => {\n  function render(props) {\n    return mount(\n      <TestEditor {...{onUpdate: jest.fn(), ...props, plotly}}>\n        <LayoutAnnoPanel name=\"Layout\" annotationIndex={0}>\n          <AnnotationRef attr=\"yref\" />\n        </LayoutAnnoPanel>\n      </TestEditor>\n    );\n  }\n\n  it('computes axes options for all axes using title and ids as labels', () => {\n    const fixtureProps = fixtures.scatter({\n      layout: {annotations: [{text: 'thor'}]},\n    });\n    const drop = render({...fixtureProps}).find(DropdownWidget);\n\n    const options = drop.first().prop('options');\n    expect(options.length).toBe(3);\n    expect(options[0]).toEqual({label: 'Canvas', value: 'paper'});\n    expect(options[1]).toEqual({label: 'Y 1', value: 'y'});\n    expect(options[2]).toEqual({label: 'Y: yaxis2 title', value: 'y2'});\n  });\n\n  it('sends update for a[x|y]ref attr on [x|y]ref change', () => {\n    const beforeUpdateLayout = jest.fn();\n    const fixtureProps = fixtures.scatter({\n      layout: {annotations: [{text: 'thor', ayref: 'y'}]},\n    });\n    const drop = render({beforeUpdateLayout, ...fixtureProps}).find(DropdownWidget);\n\n    drop.prop('onChange')('y2');\n\n    const {update} = beforeUpdateLayout.mock.calls[0][0];\n    expect(update).toEqual({\n      'annotations[0].ayref': 'y2',\n      'annotations[0].yref': 'y2',\n    });\n  });\n\n  it('does not send update for a[x|y]ref attr on \"paper\" change', () => {\n    const beforeUpdateLayout = jest.fn();\n    const fixtureProps = fixtures.scatter({\n      layout: {annotations: [{text: 'thor', ayref: 'y'}]},\n    });\n    const drop = render({beforeUpdateLayout, ...fixtureProps}).find(DropdownWidget);\n\n    drop.prop('onChange')('paper');\n    const {update} = beforeUpdateLayout.mock.calls[0][0];\n    expect(update).toEqual({\n      'annotations[0].yref': 'paper',\n    });\n  });\n\n  it('does not send update for a[x|y]ref when a[x|y]ref is pixel', () => {\n    const beforeUpdateLayout = jest.fn();\n    const fixtureProps = fixtures.scatter({\n      layout: {annotations: [{text: 'thor', yref: 'y', ayref: 'pixel'}]},\n    });\n    const drop = render({beforeUpdateLayout, ...fixtureProps}).find(DropdownWidget);\n\n    drop.prop('onChange')('y2');\n    const {update} = beforeUpdateLayout.mock.calls[0][0];\n    expect(update).toEqual({\n      'annotations[0].yref': 'y2',\n    });\n  });\n});\n\ndescribe('<AnnotationArrowRef>', () => {\n  function render(props) {\n    return mount(\n      <TestEditor {...{onUpdate: jest.fn(), ...props, plotly}}>\n        <LayoutAnnoPanel name=\"Layout\" annotationIndex={0}>\n          <AnnotationArrowRef attr=\"ayref\" />\n        </LayoutAnnoPanel>\n      </TestEditor>\n    );\n  }\n\n  it('uses current value of axis ref as axes option when [x|y]ref set', () => {\n    const fixtureProps = fixtures.scatter({\n      layout: {annotations: [{text: 'thor', yref: 'y'}]},\n    });\n    const drop = render({...fixtureProps}).find(DropdownWidget);\n\n    const options = drop.first().prop('options');\n    expect(options.length).toBe(2);\n    expect(options[0]).toEqual({label: 'in pixels', value: 'pixel'});\n    expect(options[1]).toEqual({label: 'according to axis', value: 'y'});\n  });\n\n  it('provides all axes options when [x|y]ref set to paper', () => {\n    const fixtureProps = fixtures.scatter({\n      layout: {annotations: [{text: 'thor', yref: 'paper'}]},\n    });\n    const drop = render({...fixtureProps}).find(DropdownWidget);\n\n    const options = drop.first().prop('options');\n    expect(options.length).toBe(3);\n    expect(options[0]).toEqual({label: 'in pixels', value: 'pixel'});\n    expect(options[1]).toEqual({label: 'Y 1', value: 'y'});\n    expect(options[2]).toEqual({label: 'Y: yaxis2 title', value: 'y2'});\n  });\n});\n"],"mappings":"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","ignoreList":[]}