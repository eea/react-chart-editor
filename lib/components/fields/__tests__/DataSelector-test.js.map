{"version":3,"file":"DataSelector-test.js","names":["_DataSelector","_interopRequireDefault","require","_Dropdown","_react","_testUtils","_connectTraceToPlot","_enzyme","_excluded","e","__esModule","default","enterModule","reactHotLoaderGlobal","undefined","module","_extends","Object","assign","bind","n","arguments","length","t","r","hasOwnProperty","call","apply","ownKeys","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","_objectSpread","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_toPropertyKey","value","configurable","writable","i","_toPrimitive","Symbol","toPrimitive","TypeError","String","Number","_objectWithoutProperties","_objectWithoutPropertiesLoose","indexOf","propertyIsEnumerable","__signature__","signature","a","render","overrides","children","attr","props","editorProps","fixtures","scatter","onUpdate","jest","fn","mount","createElement","TestEditor","plotly","find","concat","last","describe","it","dataSources","wrapper","DropdownWidget","expect","prop","toEqual","label","toBe","beforeUpdateTraces","mockClear","mock","calls","update","xsrc","x","traceIndexes","exists","pie","TraceDataSelector","connectTraceToPlot","DataSelector","text","toContain","reactHotLoader","register","leaveModule"],"sources":["../../../../src/components/fields/__tests__/DataSelector-test.js"],"sourcesContent":["/* eslint-disable no-magic-numbers*/\nimport DataSelector from '../DataSelector';\nimport DropdownWidget from '../../widgets/Dropdown';\nimport React from 'react';\nimport {TestEditor, fixtures, plotly} from 'lib/test-utils';\nimport connectTraceToPlot from 'lib/connectTraceToPlot';\nimport {mount} from 'enzyme';\n\nfunction render(overrides = {}, children) {\n  const {attr = 'x', ...props} = overrides;\n  const editorProps = {...fixtures.scatter(), onUpdate: jest.fn(), ...props};\n\n  // return the inner-most plot connected dropdown (last)\n  return mount(\n    <TestEditor {...editorProps} plotly={plotly}>\n      {children}\n    </TestEditor>\n  )\n    .find(`[attr=\"${attr}\"]`)\n    .last();\n}\n\ndescribe('DataSelector', () => {\n  it('contains options defined by dataSources', () => {\n    const {dataSources} = fixtures.scatter();\n    const wrapper = render({dataSources}).find(DropdownWidget);\n    expect(wrapper.prop('options')).toEqual([\n      {label: 'xCol', value: 'x1'},\n      {label: 'yCol', value: 'y1'},\n      {label: 'yCol2', value: 'y2'},\n    ]);\n  });\n\n  it('uses gd.data dataSrc value not fullValue when data_array', () => {\n    const wrapper = render().find(DropdownWidget);\n    expect(wrapper.prop('value')).toBe('x1');\n  });\n\n  // arrayOk not implemented in defaultEditor yet\n  it('uses gd.data dataSrc value not fullValue when arrayOk', () => {});\n\n  it('calls updatePlot with srcAttr and data when present', () => {\n    const beforeUpdateTraces = jest.fn();\n    const wrapper = render({beforeUpdateTraces}).find(DropdownWidget);\n    beforeUpdateTraces.mockClear();\n    wrapper.prop('onChange')('y1');\n    expect(beforeUpdateTraces.mock.calls[0][0]).toEqual({\n      update: {'meta.columnNames.x': 'yCol', xsrc: 'y1', x: [2, 3, 4]},\n      traceIndexes: [1],\n    });\n  });\n\n  it('is invisible when a data src does not exist for trace type', () => {\n    let wrapper = render().find(DropdownWidget);\n    expect(wrapper.exists()).toBe(true);\n\n    wrapper = render({...fixtures.pie(), attr: 'x'}).find(DropdownWidget);\n    expect(wrapper.exists()).toBe(false);\n  });\n\n  it('uses trace specific label', () => {\n    const TraceDataSelector = connectTraceToPlot(DataSelector);\n    const wrapper = render(\n      {},\n      <TraceDataSelector traceIndexes={[0]} label={{pie: 'hodor', '*': 'rodoh'}} attr=\"x\" />\n    );\n    expect(wrapper.find('.field__title-text').text()).toContain('rodoh');\n  });\n});\n"],"mappings":"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","ignoreList":[]}