{"version":3,"file":"GroupCreator.js","names":["_react","_interopRequireWildcard","require","_lib","_Field","_interopRequireDefault","_Dropdown","_propTypes","_Button","_plotlyIcons","_constants","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","enterModule","reactHotLoaderGlobal","undefined","module","ownKeys","keys","getOwnPropertySymbols","o","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","_toPropertyKey","value","configurable","writable","_toPrimitive","Symbol","toPrimitive","TypeError","String","Number","__signature__","signature","UnconnectedGroupCreator","Component","getAllGroups","Set","context","data","map","props","attr","g","Boolean","canAddGroup","fullContainer","currentGroup","currentTraceIndex","index","MULTI_VALUED","fullData","some","d","addAndUpdateGroup","allGroups","parseInt","isInteger","lastGroupNumber","Math","max","updatePlot","render","localize","_","label","prefix","options","concat","sort","b","icon","createElement","PlusIcon","addButton","variant","onClick","clearable","extraComponent","__reactstandin__regenerateByEval","key","code","eval","propTypes","PropTypes","string","object","Field","contextTypes","func","array","displayName","_default","connectToContainer","_default2","exports","reactHotLoader","register","leaveModule"],"sources":["../../../src/components/fields/GroupCreator.js"],"sourcesContent":["import React, {Component} from 'react';\nimport {connectToContainer} from 'lib';\nimport Field from './Field';\nimport Dropdown from './Dropdown';\nimport PropTypes from 'prop-types';\nimport Button from '../widgets/Button';\nimport {PlusIcon} from 'plotly-icons';\nimport {MULTI_VALUED} from 'lib/constants';\n\nclass UnconnectedGroupCreator extends Component {\n  getAllGroups() {\n    return [...new Set(this.context.data.map((t) => t[this.props.attr]))].filter((g) => Boolean(g));\n  }\n\n  canAddGroup() {\n    const {fullContainer, attr} = this.props;\n    const currentGroup = fullContainer[attr];\n    const currentTraceIndex = fullContainer.index;\n\n    if (fullContainer.index === MULTI_VALUED) {\n      return this.getAllGroups().length === 0;\n    }\n\n    return (\n      !currentGroup ||\n      this.context.fullData.some((d) => d.index !== currentTraceIndex && d[attr] === currentGroup)\n    );\n  }\n\n  addAndUpdateGroup() {\n    const allGroups = this.context.fullData\n      .map((t) => parseInt(t[this.props.attr], 10))\n      .filter((n) => Number.isInteger(n));\n    // don't want to pass empty array to max\n    allGroups.push(0);\n\n    const lastGroupNumber = Math.max.apply(Math, allGroups);\n\n    this.props.updatePlot(lastGroupNumber + 1);\n  }\n\n  render() {\n    const {localize: _} = this.context;\n    const {attr, label, prefix, updatePlot} = this.props;\n\n    const options = [{label: _('None'), value: ''}];\n    const allGroups = this.getAllGroups();\n    allGroups.forEach((g) => options.push({label: `${prefix} ${g}`, value: g}));\n    options.sort((a, b) => a.value - b.value);\n\n    const icon = <PlusIcon />;\n    const addButton = this.canAddGroup() ? (\n      <Button variant=\"no-text\" icon={icon} onClick={() => this.addAndUpdateGroup()} />\n    ) : (\n      <Button variant=\"no-text--disabled\" icon={icon} onClick={() => {}} />\n    );\n\n    return (\n      <Dropdown\n        label={label}\n        attr={attr}\n        clearable={false}\n        options={options}\n        updatePlot={updatePlot}\n        extraComponent={addButton}\n      />\n    );\n  }\n}\n\nUnconnectedGroupCreator.propTypes = {\n  attr: PropTypes.string,\n  fullContainer: PropTypes.object,\n  prefix: PropTypes.string,\n  ...Field.propTypes,\n};\n\nUnconnectedGroupCreator.contextTypes = {\n  localize: PropTypes.func,\n  data: PropTypes.array,\n  fullData: PropTypes.array,\n};\n\nUnconnectedGroupCreator.displayName = 'UnconnectedGroupCreator';\n\nexport default connectToContainer(UnconnectedGroupCreator);\n"],"mappings":"6FAAA,IAAAA,MAAA,CAAAC,uBAAA,CAAAC,OAAA,WACA,IAAAC,IAAA,CAAAD,OAAA,cACA,IAAAE,MAAA,CAAAC,sBAAA,CAAAH,OAAA,aACA,IAAAI,SAAA,CAAAD,sBAAA,CAAAH,OAAA,gBACA,IAAAK,UAAA,CAAAF,sBAAA,CAAAH,OAAA,gBACA,IAAAM,OAAA,CAAAH,sBAAA,CAAAH,OAAA,uBACA,IAAAO,YAAA,CAAAP,OAAA,iBACA,IAAAQ,UAAA,CAAAR,OAAA,wBAA2C,SAAAG,uBAAAM,CAAA,SAAAA,CAAA,EAAAA,CAAA,CAAAC,UAAA,CAAAD,CAAA,EAAAE,OAAA,CAAAF,CAAA,WAAAG,yBAAAH,CAAA,wBAAAI,OAAA,iBAAAC,CAAA,KAAAD,OAAA,CAAAE,CAAA,KAAAF,OAAA,QAAAD,wBAAA,UAAAA,yBAAAH,CAAA,SAAAA,CAAA,CAAAM,CAAA,CAAAD,CAAA,GAAAL,CAAA,WAAAV,wBAAAU,CAAA,CAAAK,CAAA,MAAAA,CAAA,EAAAL,CAAA,EAAAA,CAAA,CAAAC,UAAA,QAAAD,CAAA,WAAAA,CAAA,mBAAAA,CAAA,qBAAAA,CAAA,QAAAE,OAAA,CAAAF,CAAA,MAAAM,CAAA,CAAAH,wBAAA,CAAAE,CAAA,KAAAC,CAAA,EAAAA,CAAA,CAAAC,GAAA,CAAAP,CAAA,SAAAM,CAAA,CAAAE,GAAA,CAAAR,CAAA,MAAAS,CAAA,EAAAC,SAAA,OAAAC,CAAA,CAAAC,MAAA,CAAAC,cAAA,EAAAD,MAAA,CAAAE,wBAAA,SAAAC,CAAA,IAAAf,CAAA,gBAAAe,CAAA,KAAAC,cAAA,CAAAC,IAAA,CAAAjB,CAAA,CAAAe,CAAA,OAAAG,CAAA,CAAAP,CAAA,CAAAC,MAAA,CAAAE,wBAAA,CAAAd,CAAA,CAAAe,CAAA,OAAAG,CAAA,GAAAA,CAAA,CAAAV,GAAA,EAAAU,CAAA,CAAAC,GAAA,EAAAP,MAAA,CAAAC,cAAA,CAAAJ,CAAA,CAAAM,CAAA,CAAAG,CAAA,EAAAT,CAAA,CAAAM,CAAA,EAAAf,CAAA,CAAAe,CAAA,SAAAN,CAAA,CAAAP,OAAA,CAAAF,CAAA,CAAAM,CAAA,EAAAA,CAAA,CAAAa,GAAA,CAAAnB,CAAA,CAAAS,CAAA,EAAAA,CAAA,iBAAAW,WAAA,QAAAC,oBAAA,eAAAA,oBAAA,CAAAD,WAAA,CAAAE,SAAA,CAAAF,WAAA,EAAAA,WAAA,CAAAG,MAAA,eAAAC,QAAAxB,CAAA,CAAAK,CAAA,MAAAC,CAAA,CAAAM,MAAA,CAAAa,IAAA,CAAAzB,CAAA,KAAAY,MAAA,CAAAc,qBAAA,MAAAC,CAAA,CAAAf,MAAA,CAAAc,qBAAA,CAAA1B,CAAA,EAAAK,CAAA,GAAAsB,CAAA,CAAAA,CAAA,CAAAC,MAAA,UAAAvB,CAAA,SAAAO,MAAA,CAAAE,wBAAA,CAAAd,CAAA,CAAAK,CAAA,EAAAwB,UAAA,IAAAvB,CAAA,CAAAwB,IAAA,CAAAC,KAAA,CAAAzB,CAAA,CAAAqB,CAAA,SAAArB,CAAA,UAAA0B,cAAAhC,CAAA,UAAAK,CAAA,GAAAA,CAAA,CAAA4B,SAAA,CAAAC,MAAA,CAAA7B,CAAA,QAAAC,CAAA,OAAA2B,SAAA,CAAA5B,CAAA,EAAA4B,SAAA,CAAA5B,CAAA,KAAAA,CAAA,GAAAmB,OAAA,CAAAZ,MAAA,CAAAN,CAAA,MAAA6B,OAAA,UAAA9B,CAAA,EAAA+B,eAAA,CAAApC,CAAA,CAAAK,CAAA,CAAAC,CAAA,CAAAD,CAAA,KAAAO,MAAA,CAAAyB,yBAAA,CAAAzB,MAAA,CAAA0B,gBAAA,CAAAtC,CAAA,CAAAY,MAAA,CAAAyB,yBAAA,CAAA/B,CAAA,GAAAkB,OAAA,CAAAZ,MAAA,CAAAN,CAAA,GAAA6B,OAAA,UAAA9B,CAAA,EAAAO,MAAA,CAAAC,cAAA,CAAAb,CAAA,CAAAK,CAAA,CAAAO,MAAA,CAAAE,wBAAA,CAAAR,CAAA,CAAAD,CAAA,YAAAL,CAAA,UAAAoC,gBAAApC,CAAA,CAAAK,CAAA,CAAAC,CAAA,SAAAD,CAAA,CAAAkC,cAAA,CAAAlC,CAAA,KAAAL,CAAA,CAAAY,MAAA,CAAAC,cAAA,CAAAb,CAAA,CAAAK,CAAA,EAAAmC,KAAA,CAAAlC,CAAA,CAAAuB,UAAA,IAAAY,YAAA,IAAAC,QAAA,MAAA1C,CAAA,CAAAK,CAAA,EAAAC,CAAA,CAAAN,CAAA,UAAAuC,eAAAjC,CAAA,MAAAY,CAAA,CAAAyB,YAAA,CAAArC,CAAA,kCAAAY,CAAA,CAAAA,CAAA,CAAAA,CAAA,aAAAyB,aAAArC,CAAA,CAAAD,CAAA,sBAAAC,CAAA,GAAAA,CAAA,QAAAA,CAAA,KAAAN,CAAA,CAAAM,CAAA,CAAAsC,MAAA,CAAAC,WAAA,cAAA7C,CAAA,MAAAkB,CAAA,CAAAlB,CAAA,CAAAiB,IAAA,CAAAX,CAAA,CAAAD,CAAA,iCAAAa,CAAA,QAAAA,CAAA,WAAA4B,SAAA,mEAAAzC,CAAA,CAAA0C,MAAA,CAAAC,MAAA,EAAA1C,CAAA,MAAA2C,aAAA,QAAA5B,oBAAA,eAAAA,oBAAA,CAAAnB,OAAA,CAAAgD,SAAA,UAAAvC,CAAA,SAAAA,CAAA,EAE3C,KAAM,CAAAwC,uBAAuB,QAAS,CAAAC,gBAAU,CAC9CC,YAAYA,CAAA,CAAG,CACb,MAAO,CAAC,GAAG,GAAI,CAAAC,GAAG,CAAC,IAAI,CAACC,OAAO,CAACC,IAAI,CAACC,GAAG,CAAEnD,CAAC,EAAKA,CAAC,CAAC,IAAI,CAACoD,KAAK,CAACC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC/B,MAAM,CAAEgC,CAAC,EAAKC,OAAO,CAACD,CAAC,CAAC,CAChG,CAEAE,WAAWA,CAAA,CAAG,CACZ,KAAM,CAACC,aAAa,CAAEJ,IAAI,CAAC,CAAG,IAAI,CAACD,KAAK,CACxC,KAAM,CAAAM,YAAY,CAAGD,aAAa,CAACJ,IAAI,CAAC,CACxC,KAAM,CAAAM,iBAAiB,CAAGF,aAAa,CAACG,KAAK,CAE7C,GAAIH,aAAa,CAACG,KAAK,GAAKC,uBAAY,CAAE,CACxC,MAAO,KAAI,CAACd,YAAY,CAAC,CAAC,CAACnB,MAAM,GAAK,CACxC,CAEA,MACE,CAAC8B,YAAY,EACb,IAAI,CAACT,OAAO,CAACa,QAAQ,CAACC,IAAI,CAAEC,CAAC,EAAKA,CAAC,CAACJ,KAAK,GAAKD,iBAAiB,EAAIK,CAAC,CAACX,IAAI,CAAC,GAAKK,YAAY,CAE/F,CAEAO,iBAAiBA,CAAA,CAAG,CAClB,KAAM,CAAAC,SAAS,CAAG,IAAI,CAACjB,OAAO,CAACa,QAAQ,CACpCX,GAAG,CAAEnD,CAAC,EAAKmE,QAAQ,CAACnE,CAAC,CAAC,IAAI,CAACoD,KAAK,CAACC,IAAI,CAAC,CAAE,EAAE,CAAC,CAAC,CAC5C/B,MAAM,CAAEnB,CAAC,EAAKuC,MAAM,CAAC0B,SAAS,CAACjE,CAAC,CAAC,CAAC,CAErC+D,SAAS,CAAC1C,IAAI,CAAC,CAAC,CAAC,CAEjB,KAAM,CAAA6C,eAAe,CAAGC,IAAI,CAACC,GAAG,CAAC9C,KAAK,CAAC6C,IAAI,CAAEJ,SAAS,CAAC,CAEvD,IAAI,CAACd,KAAK,CAACoB,UAAU,CAACH,eAAe,CAAG,CAAC,CAC3C,CAEAI,MAAMA,CAAA,CAAG,CACP,KAAM,CAACC,QAAQ,CAAEC,CAAC,CAAC,CAAG,IAAI,CAAC1B,OAAO,CAClC,KAAM,CAACI,IAAI,CAAEuB,KAAK,CAAEC,MAAM,CAAEL,UAAU,CAAC,CAAG,IAAI,CAACpB,KAAK,CAEpD,KAAM,CAAA0B,OAAO,CAAG,CAAC,CAACF,KAAK,CAAED,CAAC,CAAC,MAAM,CAAC,CAAEzC,KAAK,CAAE,EAAE,CAAC,CAAC,CAC/C,KAAM,CAAAgC,SAAS,CAAG,IAAI,CAACnB,YAAY,CAAC,CAAC,CACrCmB,SAAS,CAACrC,OAAO,CAAEyB,CAAC,EAAKwB,OAAO,CAACtD,IAAI,CAAC,CAACoD,KAAK,IAAAG,MAAA,CAAKF,MAAM,MAAAE,MAAA,CAAIzB,CAAC,CAAE,CAAEpB,KAAK,CAAEoB,CAAC,CAAC,CAAC,CAAC,CAC3EwB,OAAO,CAACE,IAAI,CAAC,CAAC3E,CAAC,CAAE4E,CAAC,GAAK5E,CAAC,CAAC6B,KAAK,CAAG+C,CAAC,CAAC/C,KAAK,CAAC,CAEzC,KAAM,CAAAgD,IAAI,CAAGnG,MAAA,CAAAa,OAAA,CAAAuF,aAAA,CAAC3F,YAAA,CAAA4F,QAAQ,KAAE,CAAC,CACzB,KAAM,CAAAC,SAAS,CAAG,IAAI,CAAC7B,WAAW,CAAC,CAAC,CAClCzE,MAAA,CAAAa,OAAA,CAAAuF,aAAA,CAAC5F,OAAA,CAAAK,OAAM,EAAC0F,OAAO,CAAC,SAAS,CAACJ,IAAI,CAAEA,IAAK,CAACK,OAAO,CAAEA,CAAA,GAAM,IAAI,CAACtB,iBAAiB,CAAC,CAAE,CAAE,CAAC,CAEjFlF,MAAA,CAAAa,OAAA,CAAAuF,aAAA,CAAC5F,OAAA,CAAAK,OAAM,EAAC0F,OAAO,CAAC,mBAAmB,CAACJ,IAAI,CAAEA,IAAK,CAACK,OAAO,CAAEA,CAAA,GAAM,CAAC,CAAE,CAAE,CACrE,CAED,MACE,CAAAxG,MAAA,CAAAa,OAAA,CAAAuF,aAAA,CAAC9F,SAAA,CAAAO,OAAQ,EACPgF,KAAK,CAAEA,KAAM,CACbvB,IAAI,CAAEA,IAAK,CACXmC,SAAS,CAAE,KAAM,CACjBV,OAAO,CAAEA,OAAQ,CACjBN,UAAU,CAAEA,UAAW,CACvBiB,cAAc,CAAEJ,SAAU,CAC3B,CAEL,CAACK,iCAAAC,GAAA,CAAAC,IAAA,OAAAD,GAAA,EAAAE,IAAA,CAAAD,IAAA,EACH,CAEA/C,uBAAuB,CAACiD,SAAS,CAAApE,aAAA,EAC/B2B,IAAI,CAAE0C,kBAAS,CAACC,MAAM,CACtBvC,aAAa,CAAEsC,kBAAS,CAACE,MAAM,CAC/BpB,MAAM,CAAEkB,kBAAS,CAACC,MAAM,EACrBE,cAAK,CAACJ,SAAS,CACnB,CAEDjD,uBAAuB,CAACsD,YAAY,CAAG,CACrCzB,QAAQ,CAAEqB,kBAAS,CAACK,IAAI,CACxBlD,IAAI,CAAE6C,kBAAS,CAACM,KAAK,CACrBvC,QAAQ,CAAEiC,kBAAS,CAACM,KACtB,CAAC,CAEDxD,uBAAuB,CAACyD,WAAW,CAAG,yBAAyB,CAAC,MAAAC,QAAA,CAEjD,GAAAC,uBAAkB,EAAC3D,uBAAuB,CAAC,KAAA4D,SAAA,CAAAC,OAAA,CAAA9G,OAAA,CAAA2G,QAAA,kBAAAI,cAAA,QAAA5F,oBAAA,eAAAA,oBAAA,CAAAnB,OAAA,CAAAoB,SAAA,KAAA2F,cAAA,SAAAA,cAAA,CAAAC,QAAA,CA5EpD/D,uBAAuB,mHAAA8D,cAAA,CAAAC,QAAA,CAAAL,QAAA,wHAAAM,WAAA,QAAA9F,oBAAA,eAAAA,oBAAA,CAAA8F,WAAA,CAAA7F,SAAA,CAAA6F,WAAA,EAAAA,WAAA,CAAA5F,MAAA","ignoreList":[]}