"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.shamefullyDeleteRelatedAnalysisTransforms=exports.shamefullyCreateSplitStyleProps=exports.shamefullyClearAxisTypes=exports.shamefullyAdjustSplitStyleTargetContainers=exports.shamefullyAdjustSizeref=exports.shamefullyAdjustMapbox=exports.shamefullyAdjustGeo=exports.shamefullyAdjustAxisRef=exports.shamefullyAdjustAxisDirection=exports.shamefullyAddTableColumns=void 0;var _axis_ids=require("plotly.js/src/plots/cartesian/axis_ids");var _nested_property=_interopRequireDefault(require("plotly.js/src/lib/nested_property"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(function(){var enterModule=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.enterModule:undefined;enterModule&&enterModule(module)})();var __signature__=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.default.signature:function(a){return a};var shamefullyClearAxisTypes=(graphDiv,_ref)=>{var{traceIndexes,update}=_ref;if(!Array.isArray(graphDiv._fullData)){return}var hasSrc=false;for(var key in update){if(key.substr(key.length-3)==="src"){hasSrc=true}}if(hasSrc){clearAxisTypes(graphDiv,traceIndexes)}};exports.shamefullyClearAxisTypes=shamefullyClearAxisTypes;var axLetters=["x","y","z"];function clearAxisTypes(gd,traces){for(var i=0;i<traces.length;i++){var trace=gd._fullData[i];for(var j=0;j<3;j++){var type=axLetters[j];var ax=(0,_axis_ids.getFromId)(gd,trace[type+"axis"]||type);if(ax&&ax.type!=="log"){var axAttr=ax._name;var typeAttr=axAttr+".type";(0,_nested_property.default)(gd.layout,typeAttr).set(null)}}}}var shamefullyAdjustAxisRef=(graphDiv,payload)=>{if(payload.axesToBeGarbageCollected){payload.axesToBeGarbageCollected.forEach(a=>{var axis=a.charAt(0);var axisIdNumber=Number(a.slice(1));(0,_nested_property.default)(graphDiv.layout,"".concat(axis,"axis").concat(axisIdNumber||"")).set(null);Object.keys(graphDiv.layout).filter(key=>key.startsWith(axis+"axis")).forEach(key=>{if((0,_nested_property.default)(graphDiv.layout,"".concat(key,".overlaying")).get()===a){(0,_nested_property.default)(graphDiv.layout,"".concat(key,".overlaying")).set(null)}})})}if(payload.subplotToBeGarbageCollected){(0,_nested_property.default)(graphDiv.layout,payload.subplotToBeGarbageCollected).set(null)}};exports.shamefullyAdjustAxisRef=shamefullyAdjustAxisRef;var geoRegex=/^(geo\d*)\./;var shamefullyAdjustGeo=(_ref2,_ref3)=>{var{layout}=_ref2;var{update}=_ref3;Object.keys(update).forEach(k=>{var geoMatch=geoRegex.exec(k);if(geoMatch){var geo=geoMatch[1];if(update[geo+".scope"]){update[geo+".projection"]={};update[geo+".center"]={}}if(update[geo+".projection.type"]&&(update[geo+".projection.type"]==="albers usa"||layout[geo]&&layout[geo].scope==="usa")){update[geo+".scope"]={};update[geo+".center"]={}}}})};exports.shamefullyAdjustGeo=shamefullyAdjustGeo;var shamefullyAdjustMapbox=gd=>{if(gd.layout&&gd.layout.mapbox&&gd.layout.mapbox.style){return}(0,_nested_property.default)(gd.layout,"mapbox.style").set("open-street-map")};exports.shamefullyAdjustMapbox=shamefullyAdjustMapbox;var shamefullyAddTableColumns=(graphDiv,_ref4)=>{var{traceIndexes,update}=_ref4;if(update["cells.values"]&&(!graphDiv.data[traceIndexes[0]].header||!graphDiv.data[traceIndexes[0]].header.valuessrc)){update["header.values"]=update["cells.valuessrc"]}else if(update["header.values"]===null){update["header.values"]=graphDiv.data[traceIndexes[0]].cells.valuessrc||null}else if(update["cells.values"]===null&&!graphDiv.data[traceIndexes[0]].header.valuessrc){update["header.values"]=null}};exports.shamefullyAddTableColumns=shamefullyAddTableColumns;var shamefullyAdjustSplitStyleTargetContainers=(graphDiv,_ref5)=>{var{traceIndexes,update}=_ref5;var _loop=function _loop(){if(attr&&attr.startsWith("transforms")&&attr.endsWith("groups")){var transformIndex=parseInt(attr.split("[")[1],10);var transform=graphDiv.data[traceIndexes[0]].transforms[transformIndex];if(transform&&transform.type==="groupby"&&transform.styles){if(!transform.styles.length&&update[attr]&&Array.isArray(update[attr])){var dedupedGroups=[];update[attr].forEach(group=>{if(!dedupedGroups.includes(group)){dedupedGroups.push(group)}});var styles=dedupedGroups.map(groupEl=>({target:groupEl,value:{}}));update["transforms[".concat(transformIndex,"].styles")]=styles}if(transform.styles.length&&!update[attr]){update["transforms[".concat(transformIndex,"].styles")]=[]}}}};for(var attr in update){_loop()}};exports.shamefullyAdjustSplitStyleTargetContainers=shamefullyAdjustSplitStyleTargetContainers;var shamefullyCreateSplitStyleProps=(graphDiv,attr,traceIndex,splitTraceGroup)=>{if(!Array.isArray(splitTraceGroup)){splitTraceGroup=[splitTraceGroup]}var indexOfSplitTransform=null;graphDiv.data[traceIndex].transforms.forEach((t,i)=>{if(t.type==="groupby"){indexOfSplitTransform=i}});function getProp(group){var indexOfStyleObject=null;graphDiv.data[traceIndex].transforms[indexOfSplitTransform].styles.forEach((s,i)=>{if(s.target.toString()===group){indexOfStyleObject=i}});var path=graphDiv.data[traceIndex].transforms[indexOfSplitTransform].styles[indexOfStyleObject].value;attr.split(".").forEach(p=>{if(!path[p]){path[p]={}}path=path[p]});return(0,_nested_property.default)(graphDiv.data[traceIndex].transforms[indexOfSplitTransform].styles[indexOfStyleObject].value,attr)}return splitTraceGroup.map(g=>getProp(g))};exports.shamefullyCreateSplitStyleProps=shamefullyCreateSplitStyleProps;var shamefullyDeleteRelatedAnalysisTransforms=(graphDiv,payload)=>{var parentTraceDataIndex=payload.traceIndexes[0];var parentUid=graphDiv.data[parentTraceDataIndex].uid;if(parentUid){var relatedAnalysisTraceIndexes=[];graphDiv.data.forEach((d,i)=>{if(d.transforms&&d.transforms.some(transform=>["moving-average","fit"].includes(transform.type)&&transform.inputUid===parentUid)){relatedAnalysisTraceIndexes.push(i)}});if(relatedAnalysisTraceIndexes.length){relatedAnalysisTraceIndexes.forEach(i=>{graphDiv.data.splice(i,1)})}}};exports.shamefullyDeleteRelatedAnalysisTransforms=shamefullyDeleteRelatedAnalysisTransforms;var shamefullyAdjustSizeref=(gd,_ref6)=>{var{update}=_ref6;var{"marker.size":size=null,"marker.sizesrc":src=null}=update;if(size&&src){var DEFAULT_MAX_AREA_PX=45;var scaleFactor=DEFAULT_MAX_AREA_PX*DEFAULT_MAX_AREA_PX;update["marker.sizeref"]=size.reduce((a,b)=>Math.max(a,b))/scaleFactor;update["marker.sizemode"]="area"}};exports.shamefullyAdjustSizeref=shamefullyAdjustSizeref;var shamefullyAdjustAxisDirection=(gd,_ref7)=>{var{update}=_ref7;if(update.type==="funnel"&&gd.data.length===1){gd.layout.yaxis.autorange="reversed"}};exports.shamefullyAdjustAxisDirection=shamefullyAdjustAxisDirection;;(function(){var reactHotLoader=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.default:undefined;if(!reactHotLoader){return}reactHotLoader.register(shamefullyClearAxisTypes,"shamefullyClearAxisTypes","/Users/razvan/Work/react-chart-editor/src/shame.js");reactHotLoader.register(axLetters,"axLetters","/Users/razvan/Work/react-chart-editor/src/shame.js");reactHotLoader.register(clearAxisTypes,"clearAxisTypes","/Users/razvan/Work/react-chart-editor/src/shame.js");reactHotLoader.register(shamefullyAdjustAxisRef,"shamefullyAdjustAxisRef","/Users/razvan/Work/react-chart-editor/src/shame.js");reactHotLoader.register(geoRegex,"geoRegex","/Users/razvan/Work/react-chart-editor/src/shame.js");reactHotLoader.register(shamefullyAdjustGeo,"shamefullyAdjustGeo","/Users/razvan/Work/react-chart-editor/src/shame.js");reactHotLoader.register(shamefullyAdjustMapbox,"shamefullyAdjustMapbox","/Users/razvan/Work/react-chart-editor/src/shame.js");reactHotLoader.register(shamefullyAddTableColumns,"shamefullyAddTableColumns","/Users/razvan/Work/react-chart-editor/src/shame.js");reactHotLoader.register(shamefullyAdjustSplitStyleTargetContainers,"shamefullyAdjustSplitStyleTargetContainers","/Users/razvan/Work/react-chart-editor/src/shame.js");reactHotLoader.register(shamefullyCreateSplitStyleProps,"shamefullyCreateSplitStyleProps","/Users/razvan/Work/react-chart-editor/src/shame.js");reactHotLoader.register(shamefullyDeleteRelatedAnalysisTransforms,"shamefullyDeleteRelatedAnalysisTransforms","/Users/razvan/Work/react-chart-editor/src/shame.js");reactHotLoader.register(shamefullyAdjustSizeref,"shamefullyAdjustSizeref","/Users/razvan/Work/react-chart-editor/src/shame.js");reactHotLoader.register(shamefullyAdjustAxisDirection,"shamefullyAdjustAxisDirection","/Users/razvan/Work/react-chart-editor/src/shame.js")})();;(function(){var leaveModule=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.leaveModule:undefined;leaveModule&&leaveModule(module)})();
//# sourceMappingURL=shame.js.map