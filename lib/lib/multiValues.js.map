{"version":3,"file":"multiValues.js","names":["_constants","require","_lib","enterModule","reactHotLoaderGlobal","undefined","module","__signature__","default","signature","a","deepCopyPublic","value","skipPrivateKeys","key","startsWith","window","JSON","parse","stringify","setMultiValuedContainer","intoObj","fromObj","config","arguments","length","intoVal","fromVal","charAt","MULTI_VALUED","String","Array","isArray","searchArrays","i","isPlainObject","Error","Object","keys","forEach","key2","reactHotLoader","register","leaveModule"],"sources":["../../src/lib/multiValues.js"],"sourcesContent":["import {MULTI_VALUED} from './constants';\nimport {isPlainObject} from '../lib';\n\n/**\n * Deep-copies the value using JSON. Underscored (private) keys are removed.\n * @param {*} value Some nested value from the plotDiv object.\n * @returns {*} A deepcopy of the value.\n */\nfunction deepCopyPublic(value) {\n  if (typeof value === 'undefined') {\n    return value;\n  }\n\n  const skipPrivateKeys = (key, value) => (key.startsWith('_') ? 0 : value);\n\n  return window.JSON.parse(window.JSON.stringify(value, skipPrivateKeys));\n}\n\n/*\n * WARNING: When using this function, make intoObj and fromObject are copies of\n * your objects, so that no mutations occur\n */\nfunction setMultiValuedContainer(intoObj, fromObj, key, config = {}) {\n  const intoVal = intoObj[key];\n  const fromVal = fromObj[key];\n\n  // don't merge private attrs\n  if (\n    (typeof key === 'string' && key.charAt(0) === '_' && key !== '_group') ||\n    typeof intoVal === 'function' ||\n    key === 'module'\n  ) {\n    return;\n  }\n\n  // already a mixture of values, can't get any worse\n  if (intoVal === MULTI_VALUED) {\n    return;\n  } else if (intoVal === void 0) {\n    // if the original doesn't have the key it's because that key\n    // doesn't do anything there - so use the new value\n    // note that if fromObj doesn't have a key in intoObj we will not\n    // attempt to merge them at all, so this behavior makes the merge\n    // independent of order.\n\n    // WARNING: Careful that data copies were passed in as args here, as mutation can occur\n    intoObj[key] = fromVal;\n  } else if (key === 'colorscale') {\n    // colorscales are arrays... need to stringify before comparing\n    // (other vals we don't want to stringify, as differences could\n    // potentially be real, like 'false' and false)\n    if (String(intoVal) !== String(fromVal)) {\n      intoObj[key] = MULTI_VALUED;\n    }\n  } else if (Array.isArray(intoVal)) {\n    // in data, other arrays are data, which we don't care about\n    // for styling purposes\n    if (!config.searchArrays) {\n      return;\n    }\n    if (!Array.isArray(fromVal)) {\n      intoObj[key] = MULTI_VALUED;\n    } else {\n      // in layout though, we need to recurse into arrays\n      for (let i = 0; i < fromVal.length; i++) {\n        setMultiValuedContainer(intoVal, fromVal, i, config);\n      }\n    }\n  } else if (isPlainObject(fromVal)) {\n    // recurse into objects\n    if (!isPlainObject(intoVal)) {\n      throw new Error('tried to merge object into non-object: ' + key);\n    }\n    Object.keys(fromVal).forEach(function (key2) {\n      setMultiValuedContainer(intoVal, fromVal, key2, config);\n    });\n  } else if (isPlainObject(intoVal)) {\n    throw new Error('tried to merge non-object into object: ' + key);\n  } else if (intoVal !== fromVal) {\n    // different non-empty values -\n    intoObj[key] = MULTI_VALUED;\n  }\n}\n\nexport {deepCopyPublic, setMultiValuedContainer};\n"],"mappings":"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","ignoreList":[]}