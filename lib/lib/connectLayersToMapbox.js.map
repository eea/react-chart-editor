{"version":3,"file":"connectLayersToMapbox.js","names":["_react","_interopRequireWildcard","require","_propTypes","_interopRequireDefault","_lib","_constants","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","enterModule","reactHotLoaderGlobal","undefined","module","__signature__","signature","connectLayersToMapbox","WrappedComponent","MapboxLayerConnectedComponent","Component","constructor","props","context","deleteMapboxLayer","bind","updateMapboxLayer","moveMapboxLayer","setLocals","UNSAFE_componentWillReceiveProps","nextProps","nextContext","mapboxLayerIndex","container","fullContainer","mapboxLayers","layers","fullmapboxLayers","getChildContext","getDflt","getValObject","attr","concat","updateContainer","deleteContainer","moveContainer","update","newUpdate","key","newkey","onUpdate","type","EDITOR_ACTIONS","DELETE_MAPBOXLAYER","payload","mapboxId","_subplot","id","direction","desiredIndex","MOVE_TO","fromIndex","toIndex","path","render","createElement","__reactstandin__regenerateByEval","code","eval","displayName","getDisplayName","propTypes","PropTypes","number","isRequired","contextTypes","object","data","array","func","childContextTypes","plotly_editor_traits","reactHotLoader","register","leaveModule"],"sources":["../../src/lib/connectLayersToMapbox.js"],"sourcesContent":["import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport {getDisplayName} from '../lib';\nimport {EDITOR_ACTIONS} from './constants';\n\nexport default function connectLayersToMapbox(WrappedComponent) {\n  class MapboxLayerConnectedComponent extends Component {\n    constructor(props, context) {\n      super(props, context);\n\n      this.deleteMapboxLayer = this.deleteMapboxLayer.bind(this);\n      this.updateMapboxLayer = this.updateMapboxLayer.bind(this);\n      this.moveMapboxLayer = this.moveMapboxLayer.bind(this);\n      this.setLocals(props, context);\n    }\n\n    UNSAFE_componentWillReceiveProps(nextProps, nextContext) {\n      this.setLocals(nextProps, nextContext);\n    }\n\n    setLocals(props, context) {\n      const {mapboxLayerIndex} = props;\n      const {container, fullContainer} = context;\n\n      const mapboxLayers = container.layers || [];\n      const fullmapboxLayers = fullContainer.layers || [];\n      this.container = mapboxLayers[mapboxLayerIndex];\n      this.fullContainer = fullmapboxLayers[mapboxLayerIndex];\n    }\n\n    getChildContext() {\n      return {\n        getDflt: () => undefined,\n        getValObject: (attr) =>\n          !this.context.getValObject ? null : this.context.getValObject(`layers[].${attr}`),\n        updateContainer: this.updateMapboxLayer,\n        deleteContainer: this.deleteMapboxLayer,\n        moveContainer: this.moveMapboxLayer,\n        container: this.container,\n        fullContainer: this.fullContainer,\n      };\n    }\n\n    updateMapboxLayer(update) {\n      const newUpdate = {};\n      const {mapboxLayerIndex} = this.props;\n      for (const key in update) {\n        const newkey = `layers[${mapboxLayerIndex}].${key}`;\n        newUpdate[newkey] = update[key];\n      }\n      this.context.updateContainer(newUpdate);\n    }\n\n    deleteMapboxLayer() {\n      if (this.context.onUpdate) {\n        this.context.onUpdate({\n          type: EDITOR_ACTIONS.DELETE_MAPBOXLAYER,\n          payload: {\n            mapboxId: this.context.fullContainer._subplot.id,\n            mapboxLayerIndex: this.props.mapboxLayerIndex,\n          },\n        });\n      }\n    }\n\n    moveMapboxLayer(direction) {\n      if (this.context.onUpdate) {\n        const mapboxLayerIndex = this.props.mapboxLayerIndex;\n        const desiredIndex = direction === 'up' ? mapboxLayerIndex - 1 : mapboxLayerIndex + 1;\n        this.context.onUpdate({\n          type: EDITOR_ACTIONS.MOVE_TO,\n          payload: {\n            fromIndex: mapboxLayerIndex,\n            toIndex: desiredIndex,\n            mapboxId: this.context.fullContainer._subplot.id,\n            path: 'layout.mapbox.layers',\n          },\n        });\n      }\n    }\n\n    render() {\n      return <WrappedComponent {...this.props} />;\n    }\n  }\n\n  MapboxLayerConnectedComponent.displayName = `MapboxLayerConnected${getDisplayName(\n    WrappedComponent\n  )}`;\n\n  MapboxLayerConnectedComponent.propTypes = {\n    mapboxLayerIndex: PropTypes.number.isRequired,\n  };\n\n  MapboxLayerConnectedComponent.contextTypes = {\n    container: PropTypes.object,\n    fullContainer: PropTypes.object,\n    data: PropTypes.array,\n    onUpdate: PropTypes.func,\n    updateContainer: PropTypes.func,\n    getValObject: PropTypes.func,\n  };\n\n  MapboxLayerConnectedComponent.childContextTypes = {\n    updateContainer: PropTypes.func,\n    deleteContainer: PropTypes.func,\n    moveContainer: PropTypes.func,\n    container: PropTypes.object,\n    fullContainer: PropTypes.object,\n    getValObject: PropTypes.func,\n    getDflt: PropTypes.func,\n  };\n\n  const {plotly_editor_traits} = WrappedComponent;\n  MapboxLayerConnectedComponent.plotly_editor_traits = plotly_editor_traits;\n\n  return MapboxLayerConnectedComponent;\n}\n"],"mappings":"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","ignoreList":[]}