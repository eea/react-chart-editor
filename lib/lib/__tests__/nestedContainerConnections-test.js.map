{"version":3,"file":"nestedContainerConnections-test.js","names":["_NumericInput","_interopRequireDefault","require","_react","_components","_testUtils","_","e","__esModule","default","ownKeys","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_toPropertyKey","value","configurable","writable","i","_toPrimitive","Symbol","toPrimitive","call","TypeError","String","Number","__signature__","reactHotLoaderGlobal","signature","a","describe","it","beforeUpdateLayout","jest","fn","fixtureProps","fixtures","scatter","layout","xaxis","range","LayoutAxesNumeric","connectLayoutToPlot","connectAxesToLayout","connectToContainer","Numeric","mount","createElement","TestEditor","label","attr","find","NumericInput","simulate","expect","toBeCalled","payload","mock","calls","toEqual","update","width","TraceLayoutNumeric","connectTraceToPlot","traceIndexes","DeeplyConnectedNumeric","modifyPlotProps","props","context","plotProps","connectToContainerModifiedPlotProp","wrapper","PlotlySection","name","toBe","TracePanel","PlotlyPanel","MAXWIDTH","LayoutSection","ModifiedNumeric","max","prop"],"sources":["../../../src/lib/__tests__/nestedContainerConnections-test.js"],"sourcesContent":["import NumericInput from '../../components/widgets/NumericInput';\nimport React from 'react';\nimport {Numeric, PlotlySection, PlotlyPanel} from '../../components';\nimport {TestEditor, fixtures, mount} from '../test-utils';\nimport {connectAxesToLayout, connectLayoutToPlot, connectToContainer, connectTraceToPlot} from '..';\n\ndescribe('Plot Connection', () => {\n  it('can connect Field directly with full connection pipeline', () => {\n    const beforeUpdateLayout = jest.fn();\n    const fixtureProps = fixtures.scatter({layout: {xaxis: {range: [0, 10]}}});\n    const LayoutAxesNumeric = connectLayoutToPlot(connectAxesToLayout(connectToContainer(Numeric)));\n    mount(\n      <TestEditor {...{...fixtureProps, beforeUpdateLayout}}>\n        <LayoutAxesNumeric label=\"Min\" attr=\"range[0]\" />\n      </TestEditor>\n    )\n      .find('[attr=\"range[0]\"]')\n      .find(NumericInput)\n      .find('.js-numeric-increase')\n      .simulate('click');\n\n    expect(beforeUpdateLayout).toBeCalled();\n    const payload = beforeUpdateLayout.mock.calls[0][0];\n    expect(payload).toEqual({\n      update: {'xaxis.range[0]': 1},\n    });\n  });\n\n  it('can connect to layout when connected within trace context', () => {\n    const beforeUpdateLayout = jest.fn();\n    const fixtureProps = fixtures.scatter({layout: {width: 10}});\n    const TraceLayoutNumeric = connectTraceToPlot(connectLayoutToPlot(connectToContainer(Numeric)));\n    mount(\n      <TestEditor {...{...fixtureProps, beforeUpdateLayout}}>\n        <TraceLayoutNumeric traceIndexes={[0]} label=\"Width\" attr=\"width\" />\n      </TestEditor>\n    )\n      .find('[attr=\"width\"]')\n      .find(NumericInput)\n      .find('.js-numeric-increase')\n      .simulate('click');\n\n    expect(beforeUpdateLayout).toBeCalled();\n    const payload = beforeUpdateLayout.mock.calls[0][0];\n    expect(payload).toEqual({update: {width: 11}});\n  });\n\n  // see https://github.com/plotly/react-chart-editor/issues/58#issuecomment-345492794\n  it(\"can't find correct Container when PlotlySection divides Trace and Layout\", () => {\n    const fixtureProps = fixtures.scatter({layout: {width: 10}});\n    const DeeplyConnectedNumeric = connectTraceToPlot(\n      connectLayoutToPlot(\n        connectToContainer(Numeric, {\n          modifyPlotProps: (props, context, plotProps) => {\n            plotProps.connectToContainerModifiedPlotProp = true;\n          },\n        })\n      )\n    );\n\n    const wrapper = mount(\n      <TestEditor {...{...fixtureProps}}>\n        <PlotlySection name=\"Canvas\">\n          <DeeplyConnectedNumeric traceIndexes={[0]} label=\"Width\" attr=\"width\" />\n        </PlotlySection>\n      </TestEditor>\n    )\n      .find('[attr=\"width\"]')\n      .find(Numeric);\n\n    // It is 0 because PlotlySection is passing _its_ context to unpackPlotProps.\n    // The context of PlotlySection is Trace not layout and width isn't defined\n    // in Trace. See next test for workaround.\n    expect(wrapper.length).toBe(0);\n  });\n\n  it('can modify plotProps with <Trace><PlotlySection><LayoutComp>', () => {\n    const fixtureProps = fixtures.scatter({layout: {width: 10}});\n    const TracePanel = connectTraceToPlot(PlotlyPanel);\n\n    const MAXWIDTH = 1000;\n    const LayoutSection = connectLayoutToPlot(PlotlySection);\n    const ModifiedNumeric = connectToContainer(Numeric, {\n      modifyPlotProps: (props, context, plotProps) => {\n        plotProps.max = MAXWIDTH;\n      },\n    });\n\n    const wrapper = mount(\n      <TestEditor {...{...fixtureProps}}>\n        <TracePanel traceIndexes={[0]}>\n          <LayoutSection name=\"Canvas\">\n            <ModifiedNumeric traceIndexes={[0]} label=\"Width\" attr=\"width\" />\n          </LayoutSection>\n        </TracePanel>\n      </TestEditor>\n    )\n      .find('[attr=\"width\"]')\n      .find(NumericInput);\n\n    expect(wrapper.prop('max')).toBe(MAXWIDTH);\n  });\n});\n"],"mappings":"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","ignoreList":[]}