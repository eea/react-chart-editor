"use strict";var _walkObject=_interopRequireWildcard(require("../walkObject"));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&{}.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,t&&t.set(e,n),n}(function(){var enterModule=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.enterModule:undefined;enterModule&&enterModule(module)})();var __signature__=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.default.signature:function(a){return a};var UNDEF=undefined;describe("objectUtils",()=>{describe("walkObject",()=>{var object;var callback;beforeEach(()=>{object={[null]:{ugly:"code"},foo:"foo",bar:0,[10]:{20:"three"},[UNDEF]:{really:{fugly:"code"}},_private:{gasp:"o__o"},public:{_secret:{shock:"*__*"}},array:[{},{},{}]};callback=jest.fn()});it("calls callback with the right args for each key/value pair",()=>{(0,_walkObject.default)(object,callback);expect(callback.mock.calls.length).toEqual(15);var expectedCounts={[""]:8,["10"]:1,_private:1,null:1,public:1,["public._secret"]:1,["undefined"]:1,["undefined.really"]:1};var expectedKeys=["null","ugly","foo","bar","10","20","undefined","really","fugly","_private","gasp","public","_secret","shock","array"];var actualCounts={};var actualKeys=[];callback.mock.calls.forEach(call=>{var[key,parent,path]=call;var pathString=path.join(".");actualCounts[pathString]=(actualCounts[pathString]||0)+1;actualKeys.push(key);expect(parent[key]).toBeDefined()});expect(actualCounts).toEqual(expectedCounts);expect(actualKeys.length).toEqual(expectedKeys.length);expectedKeys.forEach(key=>{expect(actualKeys.indexOf(key)).not.toEqual(-1)})});it("does not traverse when the callback returns true",()=>{callback.mockReturnValue(true);(0,_walkObject.default)(object,callback);expect(callback.mock.calls.length).toEqual(8)});it("can be used as a reducer by leveraging a function closure",()=>{var count=0;callback.mockImplementation(()=>{count++});(0,_walkObject.default)(object,callback);expect(count).toEqual(15)});it("walks into arrays if walkArrays is true",()=>{(0,_walkObject.default)(object,callback,{walkArrays:true});expect(callback.mock.calls.length).toEqual(18);var expectedCounts={[""]:8,["10"]:1,_private:1,null:1,public:1,["public._secret"]:1,["undefined"]:1,["undefined.really"]:1,array:3};var expectedKeys=["null","ugly","foo","bar","10","20","undefined","really","fugly","_private","gasp","public","_secret","shock","array","0","1","2"];var actualCounts={};var actualKeys=[];callback.mock.calls.forEach(call=>{var[key,parent,path]=call;var pathString=path.join(".");actualCounts[pathString]=(actualCounts[pathString]||0)+1;actualKeys.push(key);expect(parent[key]).toBeDefined()});expect(actualCounts).toEqual(expectedCounts);expect(actualKeys.length).toEqual(expectedKeys.length);expectedKeys.forEach(key=>{expect(actualKeys.indexOf(key)).not.toEqual(-1)})});it("walks into arrays specified by walkArraysMatchingKeys",()=>{(0,_walkObject.default)([{type:"scatter",x:[1,2,3],y:[1,2,3],transforms:[{filterId:"ababab",type:"filter",targetsrc:"hodor:99:aaaaaa"},{filterId:"bababa",type:"filter",targetsrc:"hodor:99:aaaaaa"}]},{z:[[1,2,3],[1,2,3]],type:"heatmap",transforms:[{type:"fit"},{filterId:"bababa",type:"filter",targetsrc:"hodor:99:aaaaaa"}]}],callback,{walkArraysMatchingKeys:["transforms","data"]});var actualCounts={};var actualKeys=[];callback.mock.calls.forEach(call=>{var[key,parent,path]=call;var pathString=path.join(".");actualCounts[pathString]=(actualCounts[pathString]||0)+1;actualKeys.push(key);expect(parent[key]).toBeDefined()});expect(actualCounts).toEqual({["0"]:4,["1"]:3,[""]:2,["0.transforms"]:2,["0.transforms.0"]:3,["0.transforms.1"]:3,["1.transforms"]:2,["1.transforms.0"]:1,["1.transforms.1"]:3});expect(actualKeys).toEqual(["0","type","x","y","transforms","0","filterId","type","targetsrc","1","filterId","type","targetsrc","1","z","type","transforms","0","type","1","filterId","type","targetsrc"])});it("produces nestedProperty style paths",()=>{(0,_walkObject.default)({a:1,b:[{c:4},2,3]},callback,{walkArraysMatchingKeys:["b"],pathType:"nestedProperty"});var actualPaths=callback.mock.calls.map(args=>args[2]);var expectedPaths=["a","b","b[0]","b[0].c","b[1]","b[2]"];expect(actualPaths).toEqual(expectedPaths);callback.mockClear();(0,_walkObject.default)({[UNDEF]:1,b:[{c:[{a:1,d:[{a:1}]}]},2,3]},callback,{walkArraysMatchingKeys:["b","c"],pathType:"nestedProperty"});actualPaths=callback.mock.calls.map(args=>args[2]);expectedPaths=["undefined","b","b[0]","b[0].c","b[0].c[0]","b[0].c[0].a","b[0].c[0].d","b[1]","b[2]"];expect(actualPaths).toEqual(expectedPaths)})});describe("makeAttrSetterPath",()=>{function test(input,expected){expect((0,_walkObject.makeAttrSetterPath)(input)).toEqual(expected)}it("creates a basic path",()=>{test(["foo","bar",3,"value"],"foo.bar[3].value")});it("accepts array index notation",()=>{test(["foo","bar",[3],"value"],"foo.bar[3].value")});it("accepts array index notation with strings",()=>{test(["foo","bar",["3"],"value"],"foo.bar[3].value")});it("strips _fullData prefix",()=>{test(["_fullData",2,"bar",3,"value"],"bar[3].value")});it("strips _fullInput prefix",()=>{test(["_fullData",2,"_fullInput","bar",3,"value"],"bar[3].value")});it("strips _fullLayout prefix",()=>{test(["_fullLayout","bar",3,"value"],"bar[3].value")})})});;(function(){var reactHotLoader=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.default:undefined;if(!reactHotLoader){return}reactHotLoader.register(UNDEF,"UNDEF","/Users/razvan/Work/react-chart-editor/src/lib/__tests__/walkObject-test.js")})();;(function(){var leaveModule=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.leaveModule:undefined;leaveModule&&leaveModule(module)})();
//# sourceMappingURL=walkObject-test.js.map