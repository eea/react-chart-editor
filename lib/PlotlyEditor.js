"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _react=_interopRequireWildcard(require("react"));var _factory=_interopRequireDefault(require("react-plotly.js/factory"));var _propTypes=_interopRequireDefault(require("prop-types"));var _constants=require("./lib/constants");var _EditorControls=_interopRequireDefault(require("./EditorControls"));var _DataSourcesEditor=_interopRequireDefault(require("./DataSourcesEditor"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&{}.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,t&&t.set(e,n),n}(function(){var enterModule=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.enterModule:undefined;enterModule&&enterModule(module)})();var __signature__=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.default.signature:function(a){return a};class PlotlyEditor extends _react.Component{constructor(props){super();this.state={graphDiv:{}};this.editor=(0,_react.createRef)();this.PlotComponent=(0,_factory.default)(props.plotly);this.handleRender=this.handleRender.bind(this);this.onPlotResize=this.onPlotResize.bind(this)}handleRender(fig,graphDiv){this.setState({graphDiv});if(this.props.onRender){this.props.onRender(graphDiv.data,graphDiv.layout,graphDiv._transitionData._frames)}}onPlotResize(){var containerEl=document.querySelector(".grid_and_plot");var gridEl=containerEl.querySelector(".grid_panel");var previewEl=containerEl.querySelector(".grid_panel__resize-preview");var plotEl=containerEl.querySelector(".plot_panel");requestAnimationFrame(()=>{plotEl.style.height=Math.max(_constants.MIN_PLOT_HEIGHT,containerEl.clientHeight-(gridEl.offsetHeight+previewEl.offsetHeight))+"px";window.dispatchEvent(new Event("resize"))})}render(){var _this$editor$current,_this=this;var GridAndPlotSlot=this.props.slots["grid-and-plot"];return _react.default.createElement("div",{className:"plotly_editor plotly-editor--theme-provider"},!this.props.hideControls&&_react.default.createElement(_EditorControls.default,{ref:this.editor,customColors:this.props.customColors,graphDiv:this.state.graphDiv,dataSources:this.props.dataSources,dataSourceOptions:this.props.dataSourceOptions,defaults:this.props.defaults,plotly:this.props.plotly,onUpdate:this.props.onUpdate,onUpdateDataSources:this.props.onUpdateDataSources,advancedTraceTypeSelector:this.props.advancedTraceTypeSelector,locale:this.props.locale,traceTypesConfig:this.props.traceTypesConfig,dictionaries:this.props.dictionaries,showFieldTooltips:this.props.showFieldTooltips,srcConverters:this.props.srcConverters,makeDefaultTrace:this.props.makeDefaultTrace,glByDefault:this.props.glByDefault,mapBoxAccess:Boolean(this.props.config&&this.props.config.mapboxAccessToken),fontOptions:this.props.fontOptions,chartHelp:this.props.chartHelp,customConfig:this.props.customConfig,ctx:this.props.ctx},this.props.children),_react.default.createElement("div",{className:"grid_and_plot"},GridAndPlotSlot&&_react.default.createElement(GridAndPlotSlot,null),_react.default.createElement(_DataSourcesEditor.default,{data:this.props.data,layout:this.props.layout,dataSources:this.props.dataSources,srcConverters:this.props.srcConverters,onUpdate:(_this$editor$current=this.editor.current)===null||_this$editor$current===void 0?void 0:_this$editor$current.handleUpdate.bind(this.editor.current),onPlotResize:this.onPlotResize}),_react.default.createElement("div",{className:"plot_panel"},_react.default.createElement(this.PlotComponent,{data:this.props.data,layout:this.props.layout,frames:this.props.frames,config:this.props.config,useResizeHandler:this.props.useResizeHandler,debug:this.props.debug,onInitialized:function onInitialized(){_this.handleRender(...arguments);_this.onPlotResize()},onUpdate:this.handleRender,style:{width:"100%",height:"100%"},divId:this.props.divId}))))}__reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}PlotlyEditor.propTypes={children:_propTypes.default.any,layout:_propTypes.default.object,data:_propTypes.default.array,config:_propTypes.default.object,customColors:_propTypes.default.array,defaults:_propTypes.default.object,dataSourceOptions:_propTypes.default.array,dataSources:_propTypes.default.object,frames:_propTypes.default.array,onUpdate:_propTypes.default.func,onUpdateDataSources:_propTypes.default.func,onRender:_propTypes.default.func,plotly:_propTypes.default.object,useResizeHandler:_propTypes.default.bool,debug:_propTypes.default.bool,advancedTraceTypeSelector:_propTypes.default.bool,locale:_propTypes.default.string,traceTypesConfig:_propTypes.default.object,dictionaries:_propTypes.default.object,divId:_propTypes.default.string,hideControls:_propTypes.default.bool,showFieldTooltips:_propTypes.default.bool,srcConverters:_propTypes.default.shape({toSrc:_propTypes.default.func.isRequired,fromSrc:_propTypes.default.func.isRequired}),makeDefaultTrace:_propTypes.default.func,glByDefault:_propTypes.default.bool,fontOptions:_propTypes.default.array,chartHelp:_propTypes.default.object,customConfig:_propTypes.default.object,ctx:_propTypes.default.object,slots:_propTypes.default.objectOf(_propTypes.default.element)};PlotlyEditor.defaultProps={hideControls:false,showFieldTooltips:false,fontOptions:_constants.DEFAULT_FONTS};var _default=PlotlyEditor;var _default2=exports.default=_default;;(function(){var reactHotLoader=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.default:undefined;if(!reactHotLoader){return}reactHotLoader.register(PlotlyEditor,"PlotlyEditor","/Users/razvan/Work/react-chart-editor/src/PlotlyEditor.js");reactHotLoader.register(_default,"default","/Users/razvan/Work/react-chart-editor/src/PlotlyEditor.js")})();;(function(){var leaveModule=typeof reactHotLoaderGlobal!=="undefined"?reactHotLoaderGlobal.leaveModule:undefined;leaveModule&&leaveModule(module)})();
//# sourceMappingURL=PlotlyEditor.js.map