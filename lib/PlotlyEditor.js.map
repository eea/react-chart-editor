{"version":3,"file":"PlotlyEditor.js","names":["_react","_interopRequireWildcard","require","_factory","_interopRequireDefault","_propTypes","_constants","_EditorControls","_DataSourcesEditor","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","enterModule","reactHotLoaderGlobal","undefined","module","__signature__","signature","PlotlyEditor","Component","constructor","props","state","graphDiv","editor","createRef","PlotComponent","createPlotComponent","plotly","handleRender","bind","onPlotResize","fig","setState","onRender","data","layout","_transitionData","_frames","containerEl","document","querySelector","gridEl","previewEl","plotEl","requestAnimationFrame","style","height","Math","max","MIN_PLOT_HEIGHT","clientHeight","offsetHeight","window","dispatchEvent","Event","render","_this$editor$current","_this","GridAndPlotSlot","slots","createElement","className","hideControls","ref","customColors","dataSources","dataSourceOptions","defaults","onUpdate","onUpdateDataSources","advancedTraceTypeSelector","locale","traceTypesConfig","dictionaries","showFieldTooltips","srcConverters","makeDefaultTrace","glByDefault","mapBoxAccess","Boolean","config","mapboxAccessToken","fontOptions","chartHelp","customConfig","ctx","children","current","handleUpdate","frames","useResizeHandler","debug","onInitialized","arguments","width","divId","__reactstandin__regenerateByEval","key","code","eval","propTypes","PropTypes","any","object","array","func","bool","string","shape","toSrc","isRequired","fromSrc","objectOf","element","defaultProps","DEFAULT_FONTS","_default","_default2","exports","reactHotLoader","register","leaveModule"],"sources":["../src/PlotlyEditor.js"],"sourcesContent":["import React, {Component, createRef} from 'react';\nimport createPlotComponent from 'react-plotly.js/factory';\nimport PropTypes from 'prop-types';\nimport {DEFAULT_FONTS, MIN_PLOT_HEIGHT} from 'lib/constants';\n\nimport EditorControls from './EditorControls';\nimport DataSourcesEditor from './DataSourcesEditor';\n\nclass PlotlyEditor extends Component {\n  constructor(props) {\n    super();\n    this.state = {graphDiv: {}};\n    this.editor = createRef();\n    this.PlotComponent = createPlotComponent(props.plotly);\n    this.handleRender = this.handleRender.bind(this);\n    this.onPlotResize = this.onPlotResize.bind(this);\n  }\n\n  handleRender(fig, graphDiv) {\n    this.setState({graphDiv});\n    if (this.props.onRender) {\n      this.props.onRender(graphDiv.data, graphDiv.layout, graphDiv._transitionData._frames);\n    }\n  }\n\n  onPlotResize() {\n    const containerEl = document.querySelector('.grid_and_plot');\n    const gridEl = containerEl.querySelector('.grid_panel');\n    const previewEl = containerEl.querySelector('.grid_panel__resize-preview');\n    const plotEl = containerEl.querySelector('.plot_panel');\n\n    requestAnimationFrame(() => {\n      plotEl.style.height =\n        Math.max(\n          MIN_PLOT_HEIGHT,\n          containerEl.clientHeight - (gridEl.offsetHeight + previewEl.offsetHeight)\n        ) + 'px';\n      window.dispatchEvent(new Event('resize'));\n    });\n  }\n\n  render() {\n    const GridAndPlotSlot = this.props.slots['grid-and-plot'];\n\n    return (\n      <div className=\"plotly_editor plotly-editor--theme-provider\">\n        {!this.props.hideControls && (\n          <EditorControls\n            ref={this.editor}\n            customColors={this.props.customColors}\n            graphDiv={this.state.graphDiv}\n            dataSources={this.props.dataSources}\n            dataSourceOptions={this.props.dataSourceOptions}\n            defaults={this.props.defaults}\n            plotly={this.props.plotly}\n            onUpdate={this.props.onUpdate}\n            onUpdateDataSources={this.props.onUpdateDataSources}\n            advancedTraceTypeSelector={this.props.advancedTraceTypeSelector}\n            locale={this.props.locale}\n            traceTypesConfig={this.props.traceTypesConfig}\n            dictionaries={this.props.dictionaries}\n            showFieldTooltips={this.props.showFieldTooltips}\n            srcConverters={this.props.srcConverters}\n            makeDefaultTrace={this.props.makeDefaultTrace}\n            glByDefault={this.props.glByDefault}\n            mapBoxAccess={Boolean(this.props.config && this.props.config.mapboxAccessToken)}\n            fontOptions={this.props.fontOptions}\n            chartHelp={this.props.chartHelp}\n            customConfig={this.props.customConfig}\n            ctx={this.props.ctx}\n          >\n            {this.props.children}\n          </EditorControls>\n        )}\n        <div className=\"grid_and_plot\">\n          {GridAndPlotSlot && <GridAndPlotSlot />}\n          <DataSourcesEditor\n            data={this.props.data}\n            layout={this.props.layout}\n            dataSources={this.props.dataSources}\n            srcConverters={this.props.srcConverters}\n            onUpdate={this.editor.current?.handleUpdate.bind(this.editor.current)}\n            onPlotResize={this.onPlotResize}\n          />\n          <div className=\"plot_panel\">\n            <this.PlotComponent\n              data={this.props.data}\n              layout={this.props.layout}\n              frames={this.props.frames}\n              config={this.props.config}\n              useResizeHandler={this.props.useResizeHandler}\n              debug={this.props.debug}\n              onInitialized={(...args) => {\n                this.handleRender(...args);\n                this.onPlotResize();\n              }}\n              onUpdate={this.handleRender}\n              style={{width: '100%', height: '100%'}}\n              divId={this.props.divId}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nPlotlyEditor.propTypes = {\n  children: PropTypes.any,\n  layout: PropTypes.object,\n  data: PropTypes.array,\n  config: PropTypes.object,\n  customColors: PropTypes.array,\n  defaults: PropTypes.object,\n  dataSourceOptions: PropTypes.array,\n  dataSources: PropTypes.object,\n  frames: PropTypes.array,\n  onUpdate: PropTypes.func,\n  onUpdateDataSources: PropTypes.func,\n  onRender: PropTypes.func,\n  plotly: PropTypes.object,\n  useResizeHandler: PropTypes.bool,\n  debug: PropTypes.bool,\n  advancedTraceTypeSelector: PropTypes.bool,\n  locale: PropTypes.string,\n  traceTypesConfig: PropTypes.object,\n  dictionaries: PropTypes.object,\n  divId: PropTypes.string,\n  hideControls: PropTypes.bool,\n  showFieldTooltips: PropTypes.bool,\n  srcConverters: PropTypes.shape({\n    toSrc: PropTypes.func.isRequired,\n    fromSrc: PropTypes.func.isRequired,\n  }),\n  makeDefaultTrace: PropTypes.func,\n  glByDefault: PropTypes.bool,\n  fontOptions: PropTypes.array,\n  chartHelp: PropTypes.object,\n  customConfig: PropTypes.object,\n  ctx: PropTypes.object,\n  slots: PropTypes.objectOf(PropTypes.element),\n};\n\nPlotlyEditor.defaultProps = {\n  hideControls: false,\n  showFieldTooltips: false,\n  fontOptions: DEFAULT_FONTS,\n};\n\nexport default PlotlyEditor;\n"],"mappings":"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","ignoreList":[]}